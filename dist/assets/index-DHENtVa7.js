import{r as w,q as Z,s as E,a as I,v as S,g as B,o as d,i as y,w as t,b as n,f as k,t as z,u as e,Y as ee,d as A,C as D,x as ne,y as te,l as O,j as V,I as M,H as ae,an as oe,ae as H,B as P,L as le,ao as se,ap as K,c as x,N as ie,O as ue,P as ce,Q as re,U as de,a6 as _e,ak as pe,aq as fe,F as L,k as X,ag as ge,V as Q,ar as me,D as ve,m as ye,_ as be,h as ke}from"./index-BKuZjElQ.js";import{g as we}from"./dict.data-Bhl9oU6X.js";import{F as Ce}from"./Field-CAXwbqSR.js";import{O as he,A as xe}from"./OrderedListOutlined-D5k1_OGP.js";import{_ as $e}from"./Operation.vue_vue_type_script_setup_true_lang-0TYptOtC.js";import{_ as Ne}from"./SystemTable.vue_vue_type_script_setup_true_lang-q25kBky5.js";import"./FilterOutlined-DwkC-MSK.js";const N=w(!1),W={configId:0,configName:"",configKey:"",configValue:"",configType:"",createBy:"",createTime:null,updateBy:"",updateTime:null,remark:""},c=w({...W}),Be=()=>{c.value={...W}},Te={configId:[{required:!1,trigger:"change"}],configName:[{required:!0,trigger:"change"}],configKey:[{required:!0,trigger:"change"}],configValue:[{required:!0,trigger:"change"}],configType:[{required:!1,trigger:"change"}],createBy:[{required:!1,trigger:"change"}],createTime:[{required:!1,trigger:"change"}],updateBy:[{required:!1,trigger:"change"}],updateTime:[{required:!1,trigger:"change"}],remark:[{required:!1,trigger:"change"}]},h=w({rowKey:"configId",data:[],loading:!1,moduleName:"config"}),q=w("table"),_=w({pageNum:1,pageSize:10,total:0,configName:"",configKey:"",configValue:"",configType:""}),f=w([]),Ie=[{label:"删除",key:"delete",icon:Z(E),async onClick(){await G(),v()}}],De=a=>I.get("system/config/list",{params:a}),Oe=a=>I.get(`system/config/${a}`),qe=a=>I.post("system/config",a),Ve=a=>I.put("/system/config",a),Ue=a=>I.delete(`system/config/${a.join(",")}`),v=async()=>{h.value.loading=!0;const{data:a}=await De(_.value);h.value.data=a.rows,_.value.total=a.total,h.value.loading=!1},U=async a=>{let i=a||f.value[0];h.value.loading=!0;const{data:l}=await Oe(i);l.data&&(c.value=l.data,N.value=!0),h.value.loading=!1},Fe=async()=>{Be(),N.value=!0},G=async a=>{let i=a?[a]:f.value;await S(Ue,i),await v(),f.value=[]},Ke=k("span",null,"已选:",-1),Se=B({__name:"AXFooter",setup(a){const i=(l,u)=>{_.value.pageNum=l,_.value.pageSize=u,v()};return(l,u)=>{const o=ee,s=A,r=D;return d(),y(r,{bordered:!1,bodyStyle:{padding:"4px 12px"},class:"card__footer"},{default:t(()=>[n(s,{justify:"space-between",align:"center"},{default:t(()=>[k("div",null,[Ke,k("span",null,"（"+z(e(f).length)+"）",1)]),n(o,{total:e(_).total,current:e(_).pageNum,"page-size":e(_).pageSize,"show-size-changer":"",onChange:i,"show-quick-jumper":"","show-less-items":""},null,8,["total","current","page-size"])]),_:1})]),_:1})}}}),R=w(),ze=async()=>{const{data:a}=await we("sys_yes_no");a.data&&(R.value=ne(a.data))},Ae=B({__name:"AXForm",setup(a){const i=w(!1),l=async()=>{i.value=!0,c.value.configId?await S(Ve,c.value):await S(qe,c.value),await v(),i.value=!1,N.value=!1};return(u,o)=>{const s=M,r=ae,C=oe,p=H,$=P,m=D,T=le;return d(),y(T,{rules:e(Te),model:e(c),onFinish:l,"wrapper-col":{span:8,offset:1},"label-col":{span:4,offset:4}},{default:t(()=>[n(te,{title:"参数配置",visible:e(N),"onUpdate:visible":o[5]||(o[5]=g=>O(N)?N.value=g:null)},{default:t(()=>[n(m,{title:"编辑/新增"},{extra:t(()=>[n($,{htmlType:"submit",type:"primary",loading:e(i),block:""},{default:t(()=>[V("保存")]),_:1},8,["loading"])]),default:t(()=>[n(r,{label:"参数名称",name:"configName"},{default:t(()=>[n(s,{placeholder:"请输入参数名称",value:e(c).configName,"onUpdate:value":o[0]||(o[0]=g=>e(c).configName=g)},null,8,["value"])]),_:1}),n(r,{label:"参数键名",name:"configKey"},{default:t(()=>[n(s,{placeholder:"请输入参数键名",value:e(c).configKey,"onUpdate:value":o[1]||(o[1]=g=>e(c).configKey=g)},null,8,["value"])]),_:1}),n(r,{label:"参数键值",name:"configValue"},{default:t(()=>[n(C,{placeholder:"请输入参数键值",value:e(c).configValue,"onUpdate:value":o[2]||(o[2]=g=>e(c).configValue=g)},null,8,["value"])]),_:1}),n(r,{label:"系统内置（Y是 N否）",name:"configType"},{default:t(()=>[n(p,{value:e(c).configType,"onUpdate:value":o[3]||(o[3]=g=>e(c).configType=g),class:"w-100",placeholder:"请选择系统内置（Y是 N否）","allow-clear":"",onChange:e(v),options:e(R)},null,8,["value","onChange","options"])]),_:1}),n(r,{label:"备注",name:"remark"},{default:t(()=>[n(C,{placeholder:"请输入备注",value:e(c).remark,"onUpdate:value":o[4]||(o[4]=g=>e(c).remark=g)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1},8,["rules","model"])}}}),j=w([{title:"参数名称",dataIndex:"configName"},{title:"参数键名",dataIndex:"configKey"},{title:"参数键值",dataIndex:"configValue"},{title:"系统内置（Y是 N否）",dataIndex:"configType"},{title:"备注",dataIndex:"remark"}]),Re=k("h3",{class:"text-14"},"系统配置列表",-1),je=B({__name:"AXHead",setup(a){return(i,l)=>{const u=M,o=H,s=P,r=A,C=ie,p=ue,$=ce,m=re,T=E,g=de,J=D,F=se("perm");return d(),y(J,{class:"table__head"},{title:t(()=>[Re]),default:t(()=>[n(r,{class:"mb-12",gap:12,wrap:"wrap"},{default:t(()=>[k("div",null,[n(u,{onBlur:e(v),value:e(_).configName,"onUpdate:value":l[0]||(l[0]=b=>e(_).configName=b),style:{width:"160px"},placeholder:"请输入参数名称","allow-clear":""},null,8,["onBlur","value"])]),k("div",null,[n(u,{onBlur:e(v),value:e(_).configKey,"onUpdate:value":l[1]||(l[1]=b=>e(_).configKey=b),style:{width:"160px"},placeholder:"请输入参数键名","allow-clear":""},null,8,["onBlur","value"])]),k("div",null,[n(u,{onBlur:e(v),value:e(_).configValue,"onUpdate:value":l[2]||(l[2]=b=>e(_).configValue=b),style:{width:"160px"},placeholder:"请输入参数键值","allow-clear":""},null,8,["onBlur","value"])]),k("div",null,[n(o,{value:e(_).configType,"onUpdate:value":l[3]||(l[3]=b=>e(_).configType=b),style:{width:"160px"},placeholder:"请选择系统内置（Y是 N否）","allow-clear":"",onBlur:e(v),options:e(R)},null,8,["value","onBlur","options"])]),n(s,{type:"primary",onClick:e(v)},{default:t(()=>[V("搜索")]),_:1},8,["onClick"])]),_:1}),n(r,{justify:"space-between",align:"center"},{default:t(()=>[n(r,{justify:"space-between",align:"center"},{default:t(()=>[n(r,{align:"center",gap:4},{default:t(()=>[K((d(),x("div",null,[n(p,{title:"新建"},{default:t(()=>[n(s,{type:"primary",onClick:e(Fe)},{default:t(()=>[n(C)]),_:1},8,["onClick"])]),_:1})])),[[F,"system:config:add"]]),K((d(),x("div",null,[n(p,{title:"编辑"},{default:t(()=>[n(s,{type:"link",onClick:l[4]||(l[4]=b=>e(U)()),disabled:e(f).length!==1},{default:t(()=>[n($)]),_:1},8,["disabled"])]),_:1})])),[[F,"system:config:edit"]]),n(p,{title:"刷新"},{default:t(()=>[n(s,{type:"link",onClick:e(v)},{default:t(()=>[n(m)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),n(r,null,{default:t(()=>[K((d(),x("div",null,[n(g,{title:"确定要删除吗",disabled:e(f).length===0,placement:"bottomRight",onConfirm:l[5]||(l[5]=b=>e(G)())},{default:t(()=>[n(p,{title:"批量删除"},{default:t(()=>[n(s,{danger:"",type:"link",disabled:e(f).length===0},{default:t(()=>[n(T)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["disabled"])])),[[F,"system:config:remove"]]),n(Ce,{columns:e(j),"module-name":e(h).moduleName},null,8,["columns","module-name"]),k("div",null,[e(q)==="table"?(d(),y(p,{key:0,title:"卡片模式",onClick:l[6]||(l[6]=b=>q.value="card")},{default:t(()=>[n(s,{type:"link"},{default:t(()=>[n(e(he))]),_:1})]),_:1})):(d(),y(p,{key:1,title:"表格模式",onClick:l[7]||(l[7]=b=>q.value="table")},{default:t(()=>[n(s,{type:"link"},{default:t(()=>[n(e(xe))]),_:1})]),_:1}))])]),_:1})]),_:1})]),_:1})}}}),Le=a=>{console.log("dragstart==",a.id)},Xe=a=>{console.log("drop==",a.id)},Ye=a=>{f.value.includes(a.id)?f.value=f.value.filter(i=>i!==a.id):f.value.push(a.id),console.log(f.value)},Y=_e(()=>{let a=[];return h.value.data.map((i,l)=>{let u=[];j.value.forEach((o,s)=>{const r=o.title,C=i[o.dataIndex];o.dataIndex!=="operation"&&u.push({label:r,value:C})}),a.push({id:i.configId,items:u,raw:i})}),a}),Ee=["onClick","onDblclick","onDragstart","onDrop"],Me={key:0,class:"active"},He=B({__name:"AXCard",setup(a){const i=w();return pe(()=>{fe(i,Y.value,{animation:200,onUpdate(l){}})}),(l,u)=>{const o=me,s=ve,r=ye,C=D;return d(),y(C,{bordered:!1,"body-style":{padding:"0"}},{default:t(()=>[k("ul",{class:"table_card_list flex-1",ref_key:"cardRef",ref:i},[(d(!0),x(L,null,X(e(Y),(p,$)=>(d(),x("li",{key:$,size:"small",onClick:m=>e(Ye)(p),class:ge({active:e(f).includes(p.id)}),onDblclick:m=>e(U)(p.id),draggable:!0,onDragstart:m=>e(Le)(p),onDrop:m=>e(Xe)(p),onDragover:u[0]||(u[0]=m=>m.preventDefault())},[n(C,null,{default:t(()=>[e(f).includes(p.id)?(d(),x("div",Me,z($+1),1)):Q("",!0),n(o,{title:p.items[0].value,class:"mb-8"},{description:t(()=>[V("详细信息")]),_:2},1032,["title"]),n(r,{column:1,layout:"horizontal",labelStyle:{width:"80px",color:"#666"}},{default:t(()=>[(d(!0),x(L,null,X(p.items,(m,T)=>(d(),y(s,{label:m.label,contentStyle:{fontWeight:T===0?"bold":""}},{default:t(()=>[V(z(m.value),1)]),_:2},1032,["label","contentStyle"]))),256))]),_:2},1024)]),_:2},1024)],42,Ee))),128))],512)]),_:1})}}}),Pe=be(He,[["__scopeId","data-v-502a8c21"]]),Qe=B({__name:"AXTable",setup(a){const i=u=>{c.value=u},l=u=>{U(u)};return(u,o)=>(d(),y(Ne,{columns:e(j),table:e(h),query:e(_),"onUpdate:query":o[0]||(o[0]=s=>O(_)?_.value=s:null),"selected-keys":e(f),"onUpdate:selectedKeys":o[1]||(o[1]=s=>O(f)?f.value=s:null),form:e(c),"onUpdate:form":o[2]||(o[2]=s=>O(c)?c.value=s:null),onDblclick:l},{default:t(({value:s})=>[s.column.dataIndex==="operation"?(d(),y($e,{key:0,loading:e(h).loading,onOpenChange:r=>i(s.record),onOnClick:r=>e(U)(s.record.configId),items:e(Ie)},null,8,["loading","onOpenChange","onOnClick","items"])):Q("",!0)]),_:1},8,["columns","table","query","selected-keys","form"]))}}),We={class:"data__content"},on=B({__name:"index",setup(a){return ke(async()=>{await v(),await ze()}),(i,l)=>{const u=A,o=D;return d(),y(o,{class:"system__template","body-style":{height:"100%",overflow:"hidden",paddingBottom:"0"}},{default:t(()=>[n(u,{vertical:"",class:"h-100"},{default:t(()=>[n(je),k("div",We,[e(q)==="table"?(d(),y(Qe,{key:0})):(d(),y(Pe,{key:1}))]),n(Se),n(Ae)]),_:1})]),_:1})}}});export{on as default};
