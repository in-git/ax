import{r as x,q as te,s as T,v as E,g as O,o as d,i as k,w as a,b as t,f as C,t as K,u as e,Z as ae,d as V,C as z,y as ne,l as le,j as B,ag as oe,J as se,a4 as de,I as Q,B as W,N as ce,ah as H,ai as D,c as h,O as ue,P as ie,Q as J,R as _e,V as re,aj as pe,a9 as me,ak as fe,F as L,k as M,a6 as ve,W as Z,al as be,D as ke,m as ge,_ as ye,an as Ce,ar as we,as as he,at as xe,au as $e,ao as Ie,h as Fe}from"./index-ChYhKE93.js";import{f as De,a as Se,e as Be,d as Oe,u as ze,c as Ne}from"./feedback-93ewtfLH.js";import{F as Re}from"./Field-CM81GgWv.js";import{_ as G}from"./ExportOutlined-CBNI12dm.js";import{O as Ae,A as Ue}from"./OrderedListOutlined-CMQ8YHGQ.js";const S=x(!1),Y={feedbackId:0,feedbackContent:"",type:"",nickname:"",createTime:null,updateTime:null,deptId:0,avatar:""},b=x({...Y}),Ee=()=>{b.value={...Y}},Ke={feedbackContent:[{required:!0,trigger:"change"}],type:[{required:!1,trigger:"change"}],nickname:[{required:!1,trigger:"change"}]},w=x({rowKey:"feedbackId",data:[],loading:!1,moduleName:"feedback"}),N=x("table"),u=x({pageNum:1,pageSize:10,total:0,feedbackContent:"",type:"",nickname:"",deptId:0}),c=x([]);te(T);const y=async()=>{w.value.loading=!0;const{data:o}=await De(u.value);w.value.data=o.rows,u.value.total=o.total,w.value.loading=!1},R=async o=>{let s=o||c.value[0];w.value.loading=!0;const{data:l}=await Se(s);l.data&&(b.value=l.data,S.value=!0),w.value.loading=!1},Te=async()=>{Ee(),S.value=!0},j=async o=>{let s=o?[o]:c.value;await E(Oe,s),await y(),c.value=[]},ee=()=>Be({pageNum:u.value.pageNum,pageSize:u.value.pageSize}),Ve=C("span",null,"已选:",-1),je=O({__name:"AXFooter",setup(o){const s=(l,i)=>{u.value.pageNum=l,u.value.pageSize=i,y()};return(l,i)=>{const n=ae,_=V,r=z;return d(),k(r,{bordered:!1,bodyStyle:{padding:"4px 12px"},class:"card__footer"},{default:a(()=>[t(_,{justify:"space-between",align:"center"},{default:a(()=>[C("div",null,[Ve,C("span",null,"（"+K(e(c).length)+"）",1)]),t(n,{total:e(u).total,current:e(u).pageNum,"page-size":e(u).pageSize,"show-size-changer":"",onChange:s,"show-quick-jumper":"","show-less-items":""},null,8,["total","current","page-size"])]),_:1})]),_:1})}}}),qe=O({__name:"AXForm",setup(o){const s=x(!1),l=async()=>{s.value=!0,b.value.feedbackId?await E(ze,b.value):await E(Ne,b.value),await y(),s.value=!1,S.value=!1};return(i,n)=>{const _=oe,r=se,p=de,m=Q,$=W,v=z,I=ce;return d(),k(I,{rules:e(Ke),model:e(b),onFinish:l,"wrapper-col":{span:8,offset:1},"label-col":{span:4,offset:4}},{default:a(()=>[t(ne,{title:"系统反馈",visible:e(S),"onUpdate:visible":n[3]||(n[3]=g=>le(S)?S.value=g:null)},{default:a(()=>[t(v,{title:"编辑/新增"},{extra:a(()=>[t($,{htmlType:"submit",type:"primary",loading:e(s),block:""},{default:a(()=>[B("保存")]),_:1},8,["loading"])]),default:a(()=>[t(r,{label:"反馈内容",name:"feedbackContent"},{default:a(()=>[t(_,{placeholder:"请输入反馈内容",value:e(b).feedbackContent,"onUpdate:value":n[0]||(n[0]=g=>e(b).feedbackContent=g)},null,8,["value"])]),_:1}),t(r,{label:"类型",name:"type"},{default:a(()=>[t(p,{placeholder:"请输入类型",value:e(b).type,"onUpdate:value":n[1]||(n[1]=g=>e(b).type=g)},null,8,["value"])]),_:1}),t(r,{label:"用户昵称",name:"nickname"},{default:a(()=>[t(m,{placeholder:"请输入用户昵称",value:e(b).nickname,"onUpdate:value":n[2]||(n[2]=g=>e(b).nickname=g)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1},8,["rules","model"])}}}),q=x([{title:"反馈内容",dataIndex:"feedbackContent"},{title:"类型",dataIndex:"type"},{title:"用户昵称",dataIndex:"nickname"}]),Xe=C("h3",{class:"text-14"},"系统反馈",-1),Le=O({__name:"AXHead",setup(o){return(s,l)=>{const i=Q,n=W,_=V,r=ue,p=ie,m=J,$=_e,v=G,I=T,g=re,A=z,F=H("perm");return d(),k(A,{class:"table__head"},{title:a(()=>[Xe]),default:a(()=>[t(_,{class:"mb-12",gap:12,wrap:"wrap"},{default:a(()=>[C("div",null,[t(i,{onBlur:e(y),value:e(u).feedbackContent,"onUpdate:value":l[0]||(l[0]=f=>e(u).feedbackContent=f),style:{width:"160px"},placeholder:"请输入反馈内容","allow-clear":""},null,8,["onBlur","value"])]),C("div",null,[t(i,{onBlur:e(y),value:e(u).type,"onUpdate:value":l[1]||(l[1]=f=>e(u).type=f),style:{width:"160px"},placeholder:"请输入类型","allow-clear":""},null,8,["onBlur","value"])]),C("div",null,[t(i,{onBlur:e(y),value:e(u).nickname,"onUpdate:value":l[2]||(l[2]=f=>e(u).nickname=f),style:{width:"160px"},placeholder:"请输入用户昵称","allow-clear":""},null,8,["onBlur","value"])]),C("div",null,[t(i,{onBlur:e(y),value:e(u).deptId,"onUpdate:value":l[3]||(l[3]=f=>e(u).deptId=f),style:{width:"160px"},placeholder:"请输入部门名称","allow-clear":""},null,8,["onBlur","value"])]),t(n,{type:"primary",onClick:e(y)},{default:a(()=>[B("搜索")]),_:1},8,["onClick"])]),_:1}),t(_,{justify:"space-between",align:"center"},{default:a(()=>[t(_,{justify:"space-between",align:"center"},{default:a(()=>[t(_,{align:"center",gap:4},{default:a(()=>[D((d(),h("div",null,[t(p,{title:"新建"},{default:a(()=>[t(n,{type:"primary",onClick:e(Te)},{default:a(()=>[t(r)]),_:1},8,["onClick"])]),_:1})])),[[F,"system:feedback:add"]]),D((d(),h("div",null,[t(p,{title:"编辑(双击)"},{default:a(()=>[t(n,{type:"link",onClick:l[4]||(l[4]=f=>e(R)()),disabled:e(c).length!==1},{default:a(()=>[t(m)]),_:1},8,["disabled"])]),_:1})])),[[F,"system:feedback:edit"]]),t(p,{title:"刷新"},{default:a(()=>[t(n,{type:"link",onClick:e(y)},{default:a(()=>[t($)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),t(_,null,{default:a(()=>[D((d(),h("div",null,[t(p,{title:"导出"},{default:a(()=>[t(n,{type:"link",onClick:e(ee)},{default:a(()=>[t(v)]),_:1},8,["onClick"])]),_:1})])),[[F,"system:feedback:export"]]),D((d(),h("div",null,[t(g,{title:"确定要删除吗",disabled:e(c).length===0,placement:"bottomRight",onConfirm:l[5]||(l[5]=f=>e(j)())},{default:a(()=>[t(p,{title:"批量删除"},{default:a(()=>[t(n,{danger:"",type:"link",disabled:e(c).length===0},{default:a(()=>[t(I)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["disabled"])])),[[F,"system:feedback:remove"]]),t(Re,{columns:e(q),"module-name":e(w).moduleName},null,8,["columns","module-name"]),C("div",null,[e(N)==="table"?(d(),k(p,{key:0,title:"卡片模式",onClick:l[6]||(l[6]=f=>N.value="card")},{default:a(()=>[t(n,{type:"link"},{default:a(()=>[t(e(Ae))]),_:1})]),_:1})):(d(),k(p,{key:1,title:"表格模式",onClick:l[7]||(l[7]=f=>N.value="table")},{default:a(()=>[t(n,{type:"link"},{default:a(()=>[t(e(Ue))]),_:1})]),_:1}))])]),_:1})]),_:1})]),_:1})}}}),Me=o=>{console.log("dragstart==",o.id)},Pe=o=>{console.log("drop==",o.id)},Qe=o=>{c.value.includes(o.id)?c.value=c.value.filter(s=>s!==o.id):c.value.push(o.id)},P=pe(()=>{let o=[];return w.value.data.map((s,l)=>{let i=[];q.value.forEach((n,_)=>{const r=n.title,p=s[n.dataIndex];n.dataIndex!=="operation"&&i.push({label:r,value:p})}),o.push({id:s.feedbackId,items:i,raw:s})}),o}),We=["onClick","onDblclick","onDragstart","onDrop"],He={key:0,class:"active"},Je=O({__name:"AXCard",setup(o){const s=x();return me(()=>{fe(s,P.value,{animation:200,onUpdate(l){}})}),(l,i)=>{const n=be,_=ke,r=ge,p=z;return d(),k(p,{class:"table__card",bordered:!1,"body-style":{padding:"0"}},{default:a(()=>[C("ul",{class:"table_card_list flex-1",ref_key:"cardRef",ref:s},[(d(!0),h(L,null,M(e(P),(m,$)=>(d(),h("li",{key:$,size:"small",onClick:v=>e(Qe)(m),class:ve({active:e(c).includes(m.id)}),onDblclick:v=>e(R)(m.id),draggable:!0,onDragstart:v=>e(Me)(m),onDrop:v=>e(Pe)(m),onDragover:i[0]||(i[0]=v=>v.preventDefault())},[t(p,null,{default:a(()=>[e(c).includes(m.id)?(d(),h("div",He,K($+1),1)):Z("",!0),t(n,{title:m.items[0].value,class:"mb-8"},{description:a(()=>[B("详细信息")]),_:2},1032,["title"]),t(r,{column:1,layout:"horizontal",labelStyle:{width:"80px",color:"#666"}},{default:a(()=>[(d(!0),h(L,null,M(m.items,(v,I)=>(d(),k(_,{label:v.label,contentStyle:{fontWeight:I===0?"bold":""}},{default:a(()=>[B(K(v.value),1)]),_:2},1032,["label","contentStyle"]))),256))]),_:2},1024)]),_:2},1024)],42,We))),128))],512)]),_:1})}}}),Ze=ye(Je,[["__scopeId","data-v-d92b5c34"]]),Ge=O({__name:"AXTable",setup(o){const s=n=>{b.value=n},l=n=>({onClick(){const _=n[w.value.rowKey];c.value.includes(_)?c.value=we(c.value,r=>r!==_).value:c.value.push(_),c.value=[n.feedbackId]},onDblclick(){R(n.feedbackId)}}),i=(n,_,r)=>{u.value.pageNum=n.current,u.value.pageSize=n.pageSize};return(n,_)=>{const r=J,p=T,m=he,$=G,v=xe,I=$e,g=Ie,A=z,F=H("perm");return d(),k(A,{style:{boxShadow:"none"},bordered:!1,bodyStyle:{padding:"0"}},{default:a(()=>[t(g,{onChange:i,"table-layout":"fixed",sticky:"","row-selection":{selectedRowKeys:e(c),onChange:f=>c.value=f},bordered:"",loading:e(w).loading,pagination:!1,customRow:l,rowKey:e(w).rowKey,columns:e(Ce)(e(q)),"data-source":e(w).data},{bodyCell:a(({column:f,record:U})=>[f.key==="operation"?(d(),k(I,{key:0,trigger:"click",onClick:X=>e(R)(U.feedbackId),onOpenChange:X=>s(U)},{overlay:a(()=>[t(v,null,{default:a(()=>[D((d(),h("div",null,[t(m,{onClick:X=>e(j)(U.feedbackId)},{icon:a(()=>[t(p)]),default:a(()=>[B(" 删除 ")]),_:2},1032,["onClick"])])),[[F,"system:feedback:remove"]]),D((d(),h("div",null,[t(m,{onClick:e(ee)},{icon:a(()=>[t($)]),default:a(()=>[B(" 导出 ")]),_:1},8,["onClick"])])),[[F,"system:feedback:export"]])]),_:2},1024)]),default:a(()=>[t(r)]),_:2},1032,["onClick","onOpenChange"])):Z("",!0)]),_:1},8,["row-selection","loading","rowKey","columns","data-source"])]),_:1})}}}),Ye={class:"data__content"},ot=O({__name:"index",setup(o){return Fe(async()=>{await y()}),(s,l)=>{const i=V,n=z;return d(),k(n,{class:"system__template","body-style":{height:"100%",overflow:"hidden",paddingBottom:"0"}},{default:a(()=>[t(i,{vertical:"",class:"h-100"},{default:a(()=>[t(Le),C("div",Ye,[e(N)==="table"?(d(),k(Ge,{key:0})):(d(),k(Ze,{key:1}))]),t(je),t(qe)]),_:1})]),_:1})}}});export{ot as default};
