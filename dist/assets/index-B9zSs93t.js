import{b as t,A as W,a as I,r as p,v as xe,M as de,g as D,o as v,c as w,w as s,f as i,u as a,i as E,j as B,a1 as Re,F as ie,W as K,l as T,y as q,ax as De,U as _e,B as Y,P as X,a3 as Je,_ as J,a8 as j,h as pe,R as me,ag as ve,s as Me,O as Fe,T as fe,Q as Ke,p as V,e as N,k as Te,t as ne,b0 as je,S as ge,C as ee,$ as ye,b1 as ze,d as be,I as Ae,J as Ie,aF as Ye,aC as Ve,aq as Ne,L as Le,G as He,aE as Pe,b2 as Ze,H as Ge,N as he,ae as $e,b3 as We}from"./index-_mG2u1vj.js";import qe from"./role-CL2RSENu.js";import{_ as Xe}from"./TableHead-DGGwMmAe.js";var et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 680h-54V540H546v-92h238c8.8 0 16-7.2 16-16V168c0-8.8-7.2-16-16-16H240c-8.8 0-16 7.2-16 16v264c0 8.8 7.2 16 16 16h238v92H190v140h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8zM256 805.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zm288 0c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM288 384V216h448v168H288zm544 421.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM360 300a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"cluster",theme:"outlined"};const tt=et;function se(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},u=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(o).filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable}))),u.forEach(function(r){at(e,r,o[r])})}return e}function at(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var te=function(n,o){var u=se({},n,o.attrs);return t(W,se({},u,{icon:tt}),null)};te.displayName="ClusterOutlined";te.inheritAttrs=!1;const lt=te;var nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"};const st=nt;function oe(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},u=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(o).filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable}))),u.forEach(function(r){ot(e,r,o[r])})}return e}function ot(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var ae=function(n,o){var u=oe({},n,o.attrs);return t(W,oe({},u,{icon:st}),null)};ae.displayName="UserAddOutlined";ae.inheritAttrs=!1;const ct=ae;var ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 655.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 518 759.6 444.7 759.6 362c0-137-110.8-248-247.5-248S264.7 225 264.7 362c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 901.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 641.2 432.2 610 512.2 610c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 534c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 362c0-45.9 17.9-89.1 50.3-121.6S466.3 190 512.2 190s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 362c0 45.9-17.9 89.1-50.3 121.6C601.1 516.1 558 534 512.2 534zM880 772H640c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h240c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-delete",theme:"outlined"};const rt=ut;function ce(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},u=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(o).filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable}))),u.forEach(function(r){dt(e,r,o[r])})}return e}function dt(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var le=function(n,o){var u=ce({},n,o.attrs);return t(W,ce({},u,{icon:rt}),null)};le.displayName="UserDeleteOutlined";le.inheritAttrs=!1;const it=le,_t=[{title:"用户名",dataIndex:"userName"},{title:"昵称",dataIndex:"nickName"},{title:"邮箱",dataIndex:"email"},{title:"备注",dataIndex:"remark"}],pt=e=>I.get("system/role/list",{params:e}),mt=e=>I.get(`system/menu/roleMenuTreeselect/${e}`),vt=()=>I.get("system/menu/treeselect"),ft=e=>I.get(`system/role/deptTree/${e}`),gt=e=>I.put("system/role/dataScope",e),yt=e=>I.put("system/role",e),bt=e=>I.post("system/role",e),At=e=>I.delete(`system/role/${e}`),It=e=>I.get("system/role/authUser/allocatedList",{params:e}),ht=e=>I.get("system/role/authUser/unallocatedList",{params:e}),Ct=(e,n)=>I.put(`system/role/authUser/cancelAll?roleId=${e}&userIds=${n.join(",")}`),kt=(e,n)=>I.put(`system/role/authUser/selectAll?roleId=${e}&userIds=${n.join(",")}`),G=p(!0),k=p({data:[],roleMenus:[],deptList:[]}),$=p({pageNum:1,pageSize:10,roleName:"",total:0}),l=p(),St={roleId:0,roleName:"",roleKey:"",roleSort:0,dataScope:"",menuCheckStrictly:!1,deptCheckStrictly:!1,status:"0",flag:!1,menuIds:[],admin:!1},R=p(!1),Ce=async()=>{if(l.value){z.value=!0,C.value.roleId=l.value.roleId;const{data:e}=await ht(C.value);h.value.data=e.rows,C.value.total=e.total,z.value=!1,R.value=!0,M.value={title:"已分配用户",mode:"assign"}}},ke=async()=>{if(!l.value)return;C.value.roleId=l.value.roleId;const{data:e}=await It(C.value);R.value=!0,h.value.data=e.rows,C.value.total=e.total,z.value=!1,M.value={title:"取消分配",mode:"unassign"}},z=p(!1),h=p({data:[],selectedKeys:[]}),C=p({pageNum:1,pageSize:10,total:0,roleId:void 0}),Et=e=>{h.value.selectedKeys=e.map(n=>Number(n))},M=p({title:"",mode:""}),ue=async e=>{if(!l.value)return;let n=e?[e]:h.value.selectedKeys;await xe(kt,l.value.roleId,[n]),await Ce(),h.value.selectedKeys=[]},re=async e=>{let n=e?[e]:h.value.selectedKeys;de.confirm({title:"警告",content:"该操作可能影响系统运行",async onOk(){l.value&&(await Ct(l.value.roleId,n),await ke(),h.value.selectedKeys=[])},centered:!0})},wt={class:"py-8 px-12 flex justify-between"},Qt={class:"user-list p-8"},Ot=D({__name:"RoleAssign",setup(e){return(n,o)=>{const u=De,r=_e,y=Y,_=X,c=Je;return v(),w("div",null,[t(q,{w:"90%",h:"90%",visible:a(R),"onUpdate:visible":[o[2]||(o[2]=d=>T(R)?R.value=d:null),o[3]||(o[3]=d=>R.value=!1)],title:"【新增|取消】授权"},{default:s(()=>[i("div",null,[t(u,{title:a(M).title,class:"py-0 page-border px-12"},null,8,["title"]),i("div",wt,[i("div",null,[t(r,{placeholder:"请输入身份名"})]),a(M).mode!=="unassign"?(v(),E(y,{key:0,disabled:a(h).selectedKeys.length===0,type:"primary",onClick:o[0]||(o[0]=d=>a(ue)())},{default:s(()=>[B(" 批量授权 ")]),_:1},8,["disabled"])):(v(),E(y,{key:1,type:"primary",disabled:a(h).selectedKeys.length===0,onClick:o[1]||(o[1]=d=>a(re)()),danger:""},{default:s(()=>[B(" 批量取消 ")]),_:1},8,["disabled"]))]),i("div",Qt,[t(c,{columns:a(Re)(a(_t)),loading:a(z),"data-source":a(h).data,pagination:{total:a(C).total,current:a(C).pageNum,pageSize:a(C).pageSize},"row-selection":{selectedRowKeys:a(h).selectedKeys,onChange:a(Et)},"row-key":"userId"},{bodyCell:s(({column:d,record:f})=>[d.dataIndex==="operation"?(v(),w(ie,{key:0},[a(M).mode==="unassign"?(v(),E(_,{key:0,title:""},{default:s(()=>[t(y,{type:"link",style:{color:"#fc6d6d"},onClick:b=>a(re)(f.userId)},{default:s(()=>[B(" 取消授权 ")]),_:2},1032,["onClick"])]),_:2},1024)):(v(),E(_,{key:1,title:""},{default:s(()=>[t(y,{type:"link",style:{color:"green"},onClick:b=>a(ue)(f.userId)},{default:s(()=>[B(" 授权 ")]),_:2},1032,["onClick"])]),_:2},1024))],64)):K("",!0)]),_:1},8,["columns","loading","data-source","pagination","row-selection"])])])]),_:1},8,["visible"])])}}}),Bt=J(Ot,[["__scopeId","data-v-8641ea23"]]),Ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAAXNSR0IArs4c6QAADWRJREFUeF7tnVtsVNcVhtc+M76T2DJgCDaOsccem5aLhwRoegmIVqU3mgphoI0StYqUiHgATy59yAt5aEUa4kljaBRVrZo+FBiDLFWqqkapoKqqgkQQoFQEx5ZoSxsRQUWURDxgn10NqKnrGnzm7Musfc7PG/Lea6/1/fvzMR6PEYQ/IAACtyUgwAYEQOD2BCAIbgcI3IEABMH1AAEIgjsAAuEI4AkSjht2xYQABIlJ0BgzHAEIEo4bdsWEAASJSdAYMxwBCBKOG3bFhAAEiUnQGDMcAQgSjht2xYQABIlJ0BgzHAEIEo4bdsWEAASJSdAYMxwBCBKOG3bFhAAEiUnQGDMcAQgSjht2xYQABIlJ0BgzHAEIEo4bdsWEAASJSdAYMxwBCBKOG3bFhAAEiUnQGDMcAQgSjht2xYQABIlJ0BgzHAEIEo4bdsWEAASJSdAYMxwBCBKOG3bFhAAEiUnQGDMcAQgSjht2xYQABIlJ0BgzHAEIEo4bdsWEAASJSdAYMxyBsggy2FVoltJbS77fLQSlicTicO3z2iXJ/8NTY1v38OoK3agQsCZIPnUo45PY5JG3UZJco9I0572S5POQhHNCpfVmXJB828E2SiaykihLRBWltefmakjiZm4zdW1UkJdSRx4W5O8jogXRQRZsEkgSjBP3VcYEyaeGd0uSee4ATPYHSUzStVPbiCCDnYU3SdIGOyPwPgWS8M5ntu60CzLYMfwqCfnEbAfH6eOQxN20tQrycsfwI76Qr7uLw1znkMQcW5OVtQky2FKoETXihJRyucmGXa4NSdxLT5sg+c7hZ6WUL7iHwG7HkMQub9XTtAiSbxtpkMkbbxNRs2pDcdgPSdxJWYsg+zoOP+QJMeLO2OXvFJKUP4MgHWgRZDB1+ACR2BHkQKz5LwFIwv82aBKk8D4Rzec/Lr8OIQm/TKZ2pCzI3vZCfaVH13iPybs7SMI3H2VB8p1H26WcHOc7ohudQRKeOSkLMthVWE0+neQ5nltdQRJ+eSkL8mLq4LoEJY7xGw0dRYDAB0R0lYiukBQnJsXEyDNj24/bnAuC2KSNszQQkKOS6KBXkXxt4Pzm9zQUvGMJCGKaMOobISCI/umT/Knpd29CECPxoag9AuJ4bmzLelPnQRBTZFHXJoF/5Mb6WkwcCEFMUEXNchC4nBvrW6j7YAiimyjqlY+AFK/kxrfs0tkABNFJE7XKTkD3a0kQpOyRogHNBP5FktbkxvvGdNSFIDooogYrAlLIoafe3bpTR1MQRAdF1OBHQFKnjqcIBOEXLTrSQEBIsXNgfMuQaikIokoQ+7kS+G1urO+rqs1BEFWC2M+WQG6sT/l+KxfAT/OyvR+xb8z3JuY/PfrtKyogIIgKPexlTcBLUPfuC30XVJqEICr0sJc1ASHl5wbGt/5JpUkIokIPe1kTmKTJ9apvsIIgrCNGcyoEIIgKPeyNPAEIEvmIMaAKAQiiQg97I08AgkQ+YgyoQgCCqNDD3sgTgCCRjxgDqhCAICr0YrK3oiZJdY1VVNtYTXOaaqi2oTImkxPVza0+U1GTvEYk3yNJb8mE+IuQ/vlM/9K/BoWA10GCknJwXee6RdS8Yp6DnZttWZIcoYmJ51YNLDs/20kQZDZCDn58Xkc9dX+phZJVCQe7t9eyEOKHvf3p5+50IgSxl4eVk+rvqaXevpSVs6JwiCTatyrb/cztZoEgUUh5ygyf3/FpSlR4EZvK8DhSrMzsTJ+d6RQIYpi9zfLtDyyk1vubbB4ZibME0Ru92e4vQ5BIxDnzEI2td9Hyby2J8IRmR5O+fH7Vrp4900/BE8Qsd2vVW+9rovbPav/Nm9b6Z3DQrzPZ7m9CEAZJmGhh6VdaqamrwUTpmNQUf89k060QJKJxr3k0TTUNVRGdzs5YCZlYvGJn56Wpp+FLLDvsjZ+ybtdy42dE/YBJkuvvz/b8z3/xBkEikjoEUQ8SgqgzZFsBgqhHA0HUGbKtAEHUo4Eg6gzZVoAg6tFAEHWGbCuoCHLm6DjbuUptbOXmjlK3fLIegoRGx3+jqiDXLn3Mf8gAHapwgCABALu6ROViFJ8gEIQIgrh6+wP0DUFuQVLhAEECXDRXl6hcDDxBbqUOQZjc/oaWOmponhOom4snLwdaB0HwBAl0UVxYVBQk6Hdbjv/4XKCRIAgECXRRXFgEQcylpPKJAl9imculpMoQpCRcJS2GICXh4rkYgpjLBYKYY2utMjdBLp4I9o0Aa4AUDmpbuyD0bnyJFRqd3o3cBNE7nbvVIAiT7CAIkyCmtQFBmOQCQZgEAUF4BgFBeOaCJwiTXCAIkyDwBOEZBAThmQueIExygSBMgsAThGcQEIRnLniCMMkFgjAJAk8QnkFwE+TapY94ggrRVUNLsLcRzFQaT5AQwE1s4SYI3jB1K2UIYuK2h6gJQUJAC7gFP6wYEBTnZRDEXDoQxBxba5UhiDnUEMQcW2uVIYg51BDEHFtrlSGIOdQQxBxba5UhiDnUEMQcW2uVIYg51BDEHFtrlSGIOdQQxBxba5U5CmJteMMHBf19YzO1gRcKDYcTtDw3QYL2HfV1EIRJwhCESRDT2oAgTHKBIEyCgCA8g4AgPHPBE4RJLhCESRB4gvAMAoLwzAVPECa5QBAmQeAJwjMICMIzFzxBmOQCQZgEgScIzyAgCM9c8ARhkgs3Qcr1nvRSONiIDoLYoBzgjFIuRpT/j8JSOATAqrwEgigj1FOglIsBQfQwD1IFggShZGENBLkFuRQOFmLBr/2xATnIGaVcDDxBghDVswZPED0clatAEDxBlC9RlAtAEAgS5futPBsEgSDKlyjKBSAIBIny/VaeDYJAEOVLFOUC3ASJMutSZsN3sUqhZXAtBDEIV6E0BFGAp3MrBNFJU18tCKKPpVIlCKKEz9hmCGIMbWmFIUhpvGythiC2SM9yjglBHnishyrrKphM6GYbnpDplf09o1O7F6qjvJg6uC5BiWOqdeK034Qgyza10dwld8cJo9ZZhaAPe/u7/w8gBNGKOVgxE4Is+cxCund1U7AGsGomAscz2e710z8AQcpwWUwI0pRuoKUbW8swTTSOFFIc6N2Z7tcuyGBXYTX5dDIamOxMYUKQZFWCMn0pqm2ssjNExE5JCPHFFf3p32sXJN95tF3KyfGI8TI6jglBig3PT9XTp752r9Heo1hckMj3ZtO5mWZT/hJrb3uhvtKja1EEZ2omU4IU++1a30yLls811Xrk6gqi0d5sd/p2gykLUiw8mCq8X/wEFjl6hgYyKUix5c4HF1HzynmGuo9SWfHHTDb9hTtNpEmQwweIxI4ooTM5i2lBir0Xz0hvaKGaBvyb5DZZPpbJdv9stpy1CLKv4/BDnhAjsx2Gj98iYEOQ4jkVNUlqvW8+zZlXTXXzaqiyNhnbCATRR1LQOZJ0joT8Zaa/589BYGgRJN820iCTN94mouYgh8Z9jS1BpnOuvquCqusrI4/f88SVjgebv1fdWPlhcVjPS1xe9WTX+TCDaxGkeHC+c/hZKeULYZqI255yCRIXzkKI7w+8u+VHOubVJshgS6FG1IgTUsrlOhqLcg0IYi5dIcQ5eV2uzV3qu67jFG2CFJt5uWP4EV/I13U0FuUaEMRgulJsz41vOaTrBK2CFJsa7Bh+lYR8QleDUawDQUyl6j+ZG9v2E53VtQtyU5LOwpskaYPORqNUC4IYSFPSb3LjfV/XXdmIIDf/0Z4a3i1J5nU3HIV6EER7ir/KjfV9R3tVIjImSLHZl1JHHhbk7yOiBSaad7UmBNGW3GVf+j94enzbkLaK0woZFeTmk6TtYBslE1lJlC2+dmVqEJfqQhDltG4IoiGamBwauLj9onK1OxQwLsh/zs6nDmV8Eps88jZKkmtMDsW9NgQJm5A4TiR/J8h/Y2Bs2+mwVUrZZ02QqU0NdhWapfTWku93C0FpIrG4lKZdXzu3/e6GZd+4d2WQOS6duWr0M2SQHsq1JlHhfZCs8q5WVCev1M6t/ltFlffx1F5W7erZY7q3sghieiju9U/tPVXv1c3BWwQUg8pku43fX+MHKDKI7PbT+985S5LwUwcKCUMQBXjct54euvALIvko9z459wdBOKej2NuZodHv+uT/XLFMrLdDkIjHf3ronSNEtDniYxobD4IYQ8un8On9F66TlNV8OnKnEwjiTlahOz27f3TNpPRPhC4Q440QJCbhH9tzLFnfeM9+EvR4TEbWMiYE0YLRnSJvvXL+cVH85RcC3/4NkhoECUIpgmtOvTZeTxMTyzwpl8lJyeYHPT3Pk77vf/Lamerfi9FNrzE9zqkfn74Wr6RH8PJjJLcI4JV0t/JCt5YJQBDLwHGcWwQgiFt5oVvLBCCIZeA4zi0CEMStvNCtZQIQxDJwHOcWAQjiVl7o1jIBCGIZOI5ziwAEcSsvdGuZAASxDBzHuUUAgriVF7q1TACCWAaO49wiAEHcygvdWiYAQSwDx3FuEYAgbuWFbi0TgCCWgeM4twhAELfyQreWCUAQy8BxnFsEIIhbeaFbywQgiGXgOM4tAhDErbzQrWUCEMQycBznFoF/A+xjtxT7IAtEAAAAAElFTkSuQmCC",xt="/ax/assets/role-ByePIYnt.png",Rt="/ax/assets/users-BXJH_1Yg.png",S=p(!1);p([{value:"info",payload:{title:"Info",image:xt}},{value:"resource",payload:{title:"Resource",image:Ut}},{value:"users",payload:{title:"User",image:Rt}}]);const Se=async e=>{let n=0;e?n=e:l.value&&(n=l.value.roleId);const{data:o}=await mt(n);l.value&&(k.value.roleMenus=o.menus,l.value.menuIds=o.checkedKeys),S.value=!0},Dt=async e=>{if(l.value){const{data:n}=await ft(e);k.value.deptList=n.depts,l.value.deptIds=n.checkedKeys}},U=async()=>{G.value=!0;const{data:e}=await pt($.value);k.value.data=e.rows,G.value=!1},Jt=()=>{de.confirm({title:"警告",content:"该操作可能影响系统运行",async onOk(){var e;if(l.value&&l.value.roleId){const{data:n}=await At((e=l.value)==null?void 0:e.roleId);await U(),j.success(n.msg)}},centered:!0})},Ee=()=>{l.value={...St}},O=p(!1),we=async()=>{l.value&&(await Dt(l.value.roleId),O.value=!0)},Mt=[{value:"1",label:"全部数据权限"},{value:"2",label:"自定数据权限"},{value:"3",label:"本部门数据权限"},{value:"4",label:"本部门及以下数据权限"},{value:"5",label:"仅本人数据权限"}],Ft=e=>(V("data-v-2bb9db49"),e=e(),N(),e),Kt={class:"flex gc-4 align-center"},Tt=Ft(()=>i("span",{class:"system__subtitle"},"编辑/权限:",-1)),jt=D({__name:"CardHead",setup(e){const n=async()=>{const{data:u}=await vt();u.data&&(k.value.roleMenus=u.data),S.value=!0,Ee()};pe(async()=>{await U()});const o=()=>!(l.value&&l.value.roleId);return(u,r)=>{const y=Fe,_=Y,c=X,d=_e,f=fe,b=Ke,Q=ct,g=Xe;return v(),w("div",null,[t(g,{title:"身份列表展示"},{default:s(()=>[i("div",Kt,[t(_,{type:"primary",onClick:n},{default:s(()=>[t(y)]),_:1}),t(c,{title:"重新加载"},{default:s(()=>[t(_,{type:"link",onClick:a(U)},{default:s(()=>[t(a(me))]),_:1},8,["onClick"])]),_:1}),t(d,{placeholder:"请输入角色名",value:a($).roleName,"onUpdate:value":r[0]||(r[0]=x=>a($).roleName=x),onSearch:a(U),"allow-clear":""},null,8,["value","onSearch"]),t(f,{type:"vertical"}),i("div",{class:ve(["flex gc-2 text-nowrap align-center",[o()?"gray":"active"]])},[Tt,t(c,{title:"编辑基础信息"},{default:s(()=>[t(_,{type:"text",onClick:r[1]||(r[1]=x=>a(Se)()),disabled:!a(l)},{default:s(()=>[t(b,{class:"icon"})]),_:1},8,["disabled"])]),_:1}),t(c,{title:"分配资源",onClick:a(we)},{default:s(()=>[t(_,{type:"text",disabled:!a(l)},{default:s(()=>[t(a(lt),{class:"icon"})]),_:1},8,["disabled"])]),_:1},8,["onClick"]),t(c,{title:"分配人员"},{default:s(()=>[t(_,{type:"text",disabled:!a(l),onClick:a(Ce)},{default:s(()=>[t(Q,{class:"icon"})]),_:1},8,["disabled","onClick"])]),_:1}),t(c,{title:"取消分配"},{default:s(()=>[t(_,{type:"text",disabled:!a(l),onClick:a(ke)},{default:s(()=>[t(a(it),{class:"text-danger"})]),_:1},8,["disabled","onClick"])]),_:1})],2)]),i("div",null,[t(_,{type:"link",danger:"",onClick:a(Jt),disabled:o()},{default:s(()=>[t(a(Me))]),_:1},8,["onClick","disabled"])])]),_:1})])}}}),zt=J(jt,[["__scopeId","data-v-2bb9db49"]]),Yt=e=>(V("data-v-98635ff8"),e=e(),N(),e),Vt={class:"card-list"},Nt=["onClick","onDblclick"],Lt=["src"],Ht={class:"text-14"},Pt={class:"desc mt-8 text-12"},Zt=Yt(()=>i("span",{class:"system__subtitle"},"没有更多了",-1)),Gt=D({__name:"RoleCard",setup(e){const n=o=>{l.value=je(o).cloned.value};return pe(async()=>{await U()}),(o,u)=>{const r=ge,y=fe,_=ee;return v(),E(_,{class:"role-card"},{default:s(()=>[t(zt),i("div",Vt,[t(r,{spinning:a(G)},{default:s(()=>[i("ul",null,[(v(!0),w(ie,null,Te(a(k).data,c=>{var d;return v(),w("li",{class:ve([{active:((d=a(l))==null?void 0:d.roleId)===c.roleId},"text-center"]),onClick:f=>n(c),onDblclick:f=>a(Se)(c.roleId)},[i("img",{src:a(qe),width:"32",height:"32"},null,8,Lt),i("div",null,[i("div",Ht,ne(c.roleName),1),i("div",Pt,ne(c.remark),1)])],42,Nt)}),256))])]),_:1},8,["spinning"]),t(y,{dashed:""},{default:s(()=>[Zt]),_:1})])]),_:1})}}}),$t=J(Gt,[["__scopeId","data-v-98635ff8"]]),Qe=e=>(V("data-v-4d406b2b"),e=e(),N(),e),Wt={key:0,class:"h-100 flex flex-col"},qt={class:"flex-1"},Xt=Qe(()=>i("div",null,"身份管理",-1)),ea={class:"text-12 system__subtitle"},ta={class:"flex align-center mb-8"},aa=Qe(()=>i("span",{class:"text-12 system__subtitle mr-4"},"父子关联",-1)),la=D({__name:"RoleInfo",setup(e){const n=p([]),o=p(!1),u=p(),r=p(!1),y=async()=>{if(o.value=!0,l.value){let _=l.value.menuIds;const c=u.value.halfCheckedKeys;let d=[];if(_.checked?d=_.checked.concat(_.halfCheckedKeys||[]):d=l.value.menuIds,c&&c.length>0&&(d=d.concat(c)),d=Array.from(new Set(d)),l.value.roleId){const{data:f}=await yt({...l.value,menuIds:d});j.success(f.msg)}else{const{data:f}=await bt(l.value);j.success(f.msg)}o.value=!1,await U(),Ee(),S.value=!1}};return ye(k,()=>{n.value=k.value.roleMenus},{deep:!0,immediate:!0}),(_,c)=>{const d=Y,f=be,b=ee,Q=Ae,g=Ie,x=Ye,L=Ve,H=Ne,P=Le,F=He,Z=Pe,A=Ze,Be=Ge,Ue=he;return v(),E(Ue,{model:a(l),onFinish:y,layout:"vertical"},{default:s(()=>[t(q,{w:"90%",h:"90%",visible:a(S),"onUpdate:visible":[c[7]||(c[7]=m=>T(S)?S.value=m:null),c[8]||(c[8]=m=>S.value=!1)],title:"管理身份"},{default:s(()=>[a(S)&&a(l)?(v(),w("div",Wt,[i("div",qt,[t(b,{class:"table__head"},{default:s(()=>[t(f,{justify:"space-between"},{default:s(()=>[Xt,t(d,{type:"primary",loading:a(o),htmlType:"submit"},{default:s(()=>[B("保存")]),_:1},8,["loading"])]),_:1})]),_:1}),t(b,{class:"mt-12"},{default:s(()=>[t(Be,null,{default:s(()=>[t(F,{span:12},{default:s(()=>[t(b,{bordered:!1},{default:s(()=>[t(g,{label:"身份名",name:"roleName",required:""},{default:s(()=>[t(Q,{value:a(l).roleName,"onUpdate:value":c[0]||(c[0]=m=>a(l).roleName=m)},null,8,["value"])]),_:1}),t(g,{label:"排序",name:"roleSort",required:""},{default:s(()=>[t(x,{class:"w-100",value:a(l).roleSort,"onUpdate:value":c[1]||(c[1]=m=>a(l).roleSort=m)},null,8,["value"]),i("div",ea,[t(L),B(" 数字越小，排序靠前 ")])]),_:1}),t(g,{label:"身份标识",name:"roleKey",required:""},{default:s(()=>[t(Q,{class:"w-100",value:a(l).roleKey,"onUpdate:value":c[2]||(c[2]=m=>a(l).roleKey=m)},null,8,["value"])]),_:1}),t(g,{label:"身份描叙",name:"remark"},{default:s(()=>[t(H,{autoSize:{minRows:2,maxRows:4},value:a(l).remark,"onUpdate:value":c[3]||(c[3]=m=>a(l).remark=m),placeholder:"用于描述该身份的作用"},null,8,["value"])]),_:1}),t(g,{label:"状态",required:""},{default:s(()=>[t(P,{options:a(ze)("启用","禁用"),value:a(l).status,"onUpdate:value":c[4]||(c[4]=m=>a(l).status=m)},null,8,["options","value"])]),_:1})]),_:1})]),_:1}),t(F,{span:12},{default:s(()=>[t(b,{class:"mt-8",bordered:!1},{default:s(()=>[t(g,{label:"分配菜单","label-col":{span:24}},{default:s(()=>[i("div",ta,[aa,t(Z,{checked:a(r),"onUpdate:checked":c[5]||(c[5]=m=>T(r)?r.value=m:null)},null,8,["checked"])]),t(b,{"body-style":{height:"370px",overflowY:"auto"}},{default:s(()=>[t(A,{treeData:a(n),checkable:"","block-node":"",selectable:!1,"checked-keys":a(l).menuIds,"onUpdate:checkedKeys":c[6]||(c[6]=m=>a(l).menuIds=m),fieldNames:{key:"id",title:"label"},"default-expand-parent":"","check-strictly":!a(r),ref_key:"treeRef",ref:u},null,8,["treeData","checked-keys","check-strictly"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])])):K("",!0)]),_:1},8,["visible"])]),_:1},8,["model"])}}}),na=J(la,[["__scopeId","data-v-4d406b2b"]]),Oe=e=>(V("data-v-44b4d1eb"),e=e(),N(),e),sa=Oe(()=>i("div",null,[i("h2",null,"资源分配")],-1)),oa={key:0,class:"mt-12"},ca=Oe(()=>i("span",{class:"system__subtitle"},"部门列表",-1)),ua=D({__name:"RoleResource",setup(e){const n=p(),o=p(),u=p(),r=async()=>{if(!l.value)return;const _=l.value.deptIds;l.value.deptIds instanceof Array||(l.value.deptIds=_.checked.concat(_.halfChecked));const{data:c}=await gt(l.value);j.success(c.msg),O.value=!1,U()},y=async()=>{u.value=!0,await we(),u.value=!1};return ye(k,()=>{n.value=k.value.deptList,u.value=!1},{deep:!0,immediate:!0}),(_,c)=>{const d=Y,f=be,b=ee,Q=Ae,g=Ie,x=$e,L=me,H=X,P=We,F=ge,Z=he;return v(),E(Z,{model:a(l),onFinish:r,"wrapper-col":{span:8},"label-col":{span:4}},{default:s(()=>[t(q,{w:"90%",h:"90%",visible:a(O),"onUpdate:visible":[c[4]||(c[4]=A=>T(O)?O.value=A:null),c[5]||(c[5]=A=>O.value=!1)],title:"身份资源分配"},{default:s(()=>[t(b,null,{default:s(()=>[t(f,{justify:"space-between"},{default:s(()=>[sa,t(d,{type:"primary",loading:a(u),htmlType:"submit"},{default:s(()=>[B("保存")]),_:1},8,["loading"])]),_:1})]),_:1}),a(O)&&a(l)?(v(),w("div",oa,[t(b,null,{default:s(()=>[t(g,{label:"身份名",name:"roleName",required:""},{default:s(()=>[t(Q,{value:a(l).roleName,"onUpdate:value":c[0]||(c[0]=A=>a(l).roleName=A),disabled:""},null,8,["value"])]),_:1}),t(g,{label:"身份标识",name:"roleKey",required:""},{default:s(()=>[t(Q,{value:a(l).roleKey,"onUpdate:value":c[1]||(c[1]=A=>a(l).roleKey=A),disabled:""},null,8,["value"])]),_:1}),t(g,{label:"范围",name:"dataScope",required:""},{default:s(()=>[t(x,{value:a(l).dataScope,"onUpdate:value":c[2]||(c[2]=A=>a(l).dataScope=A),options:a(Mt)},null,8,["value","options"])]),_:1}),a(l).dataScope==="2"?(v(),E(g,{key:0,name:"deptIds",required:"",label:"选择部门"},{default:s(()=>[i("div",{onClick:y,class:"mb-12 flex justify-between"},[ca,t(H,{title:"刷新"},{default:s(()=>[t(d,{type:"ghost"},{default:s(()=>[t(L)]),_:1})]),_:1})]),t(F,{spinning:a(u)},{default:s(()=>[t(P,{"tree-data":a(n),"field-names":{key:"id",title:"label"},selectable:"","selected-keys":a(l).deptIds,"onUpdate:selectedKeys":c[3]||(c[3]=A=>a(l).deptIds=A),ref_key:"treeRef",ref:o},null,8,["tree-data","selected-keys"])]),_:1},8,["spinning"])]),_:1})):K("",!0)]),_:1})])):K("",!0)]),_:1},8,["visible"])]),_:1},8,["model"])}}}),ra=J(ua,[["__scopeId","data-v-44b4d1eb"]]),da={class:"role system__module flex"},ia=D({__name:"index",setup(e){return(n,o)=>(v(),w("div",da,[t($t),t(na),t(ra),t(Bt)]))}}),va=J(ia,[["__scopeId","data-v-777a684e"]]);export{va as default};
