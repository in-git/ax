import{r as g,h as O,l as B,j,k as ee,N as ae,P as z,d as h,o as i,c as f,u as e,y as T,a,w as l,ap as ne,f as y,aq as S,K as F,x as I,e as v,aj as D,ai as K,L as V,al as te,a1 as oe,am as le,ar as se,z as ue,i as N,S as _e,q as me,as as ie,at as de,ag as re,au as ce,av as pe,ah as ve,aw as E,F as fe,I as ye,J as ge,_ as L,n as be,p as xe,B as Ie,m as ke,s as $e,v as Ce,ax as Me,C as he,ay as Ne,az as Te,aA as we,ao as Fe}from"./index-HxNFWFwR.js";import{_ as Ue}from"./FormFooter-5NEaOLHv.js";import{g as qe,d as Oe,m as Se,c as Be,u as je,a as ze}from"./tree-DYZ2AjDl.js";import{_ as De}from"./Operation.vue_vue_type_script_setup_true_lang-BzKfCqHW.js";import{_ as Ke}from"./SystemTable.vue_vue_type_script_setup_true_lang-1XGIZ7ZX.js";let U={createTime:"",menuId:0,menuName:"",parentId:0,orderNum:0,path:"",query:"",isFrame:"1",isCache:"1",menuType:"C",visible:"0",status:"0",perms:"",icon:"",children:[]};const n=g({...U}),r=g(!1),P=()=>{n.value={...U},console.log(U)},Ve=g(),$=g({rowKey:"menuId",data:[],loading:!1,moduleName:"menu"}),p=g([]),C=g({pageNum:1,pageSize:10,menuName:"",status:"",total:0}),Ee=[{label:"添加子目录",key:"create",icon:O(B),onClick(){let s=n.value.menuId;P(),n.value.parentId=s,console.log(n.value),r.value=!0}},{label:"删除",key:"delete",icon:O(j),onClick(){ee(A,p.value)}}],R=async s=>{let d=0;s?(d=s.menuId,n.value=s):p.value.length===1&&(d=p.value[0]);const{data:o}=await qe(d);o.data&&(n.value=o.data),r.value=!r.value},Le=()=>{P(),r.value=!r.value},A=s=>{ae.confirm({title:"Operational qualification",content:"This may have an impact on the system",centered:!0,async onOk(){let d="";s?d=s:d=`${p.value[0]}`;try{const{data:o}=await Oe(d);z.success(o.msg),M()}catch{}}})},M=async()=>{$.value.loading=!0;const{data:s}=await Se();s.data&&($.value.data=Be(s.data)),$.value.loading=!1},H=[{label:"文件",value:"C"},{label:"文件夹",value:"M"},{label:"按钮",value:"F"}],Pe={class:"text-999 text-12"},Re={class:"text-999 text-12 mt-4"},Ae=y("div",{class:"text-12 text-999"},"关闭窗口后是否缓存数据",-1),He=h({__name:"Params",setup(s){return(d,o)=>{const x=D,u=K,t=V,c=te;return i(),f("div",null,[e(n).menuType==="C"||e(n).menuType==="M"?(i(),f(T,{key:0},[a(u,{label:"是否为链接",name:"isFrame"},{default:l(()=>[a(x,{value:e(n).isFrame,"onUpdate:value":o[0]||(o[0]=_=>e(n).isFrame=_),options:e(ne)},null,8,["value","options"])]),_:1}),a(u,{label:e(n).isFrame!=="0"?"路径":"链接",name:"path"},{default:l(()=>[a(t,{value:e(n).path,"onUpdate:value":o[1]||(o[1]=_=>e(n).path=_)},null,8,["value"]),y("div",Pe,[a(e(S)),F(" 用户访问的路径 ")])]),_:1},8,["label"])],64)):I("",!0),e(n).menuType==="C"||e(n).menuType==="F"?(i(),v(u,{key:1,label:"权限标识",name:"perms"},{default:l(()=>[a(t,{value:e(n).perms,"onUpdate:value":o[2]||(o[2]=_=>e(n).perms=_)},null,8,["value"]),y("div",Re,[a(e(S)),F(" 对按钮级别的控制 ")])]),_:1})):I("",!0),e(n).menuType==="C"?(i(),f(T,{key:2},[a(u,{label:"组件路径",name:"component"},{default:l(()=>[a(t,{value:e(n).component,"onUpdate:value":o[3]||(o[3]=_=>e(n).component=_),placeholder:"请输入组件路径"},null,8,["value"])]),_:1}),a(u,{label:"路由参数",name:"query"},{default:l(()=>[a(t,{value:e(n).query,"onUpdate:value":o[4]||(o[4]=_=>e(n).query=_),placeholder:"请输入路由参数"},null,8,["value"])]),_:1}),a(u,{label:"允许缓存",name:"isCache"},{default:l(()=>[a(c,{"un-checked-value":"1","checked-value":"0",checked:e(n).isCache,"onUpdate:checked":o[5]||(o[5]=_=>e(n).isCache=_)},null,8,["checked"]),Ae]),_:1})],64)):I("",!0)])}}}),Je=s=>(ye("data-v-52599c4f"),s=s(),ge(),s),Qe=Je(()=>y("h2",{class:"mb-12"},"Base info",-1)),Ye=h({__name:"MenuForm",setup(s){const d=g([]),o=g([]),x=async()=>{let u="";if(n.value.menuId){const{data:t}=await je(n.value);u=t.msg}else{const{data:t}=await ze(n.value);u=t.msg}z.success(u),r.value=!r.value,M()};return oe(Ve,()=>{d.value=[n.value.parentId],o.value=[{menuId:0,menuName:"主目录",path:""},...$.value.data]},{deep:!0,immediate:!0}),(u,t)=>{const c=me,_=V,b=K,w=ie,k=D,J=de,q=re,Q=ce,Y=pe,G=ve,W=E,X=Ue,Z=fe;return i(),v(_e,{visible:e(r),"onUpdate:visible":t[6]||(t[6]=m=>N(r)?r.value=m:null),title:"Menu config"},{default:l(()=>[a(Z,{model:e(n),"label-col":{span:8},"wrapper-col":{span:16},"label-align":"left",onFinish:x,class:"flex-1 flex flex-col"},{default:l(()=>[a(W,{class:"flex-1","body-style":{height:"500px",overflowY:"auto"}},{default:l(()=>[a(G,{gutter:16},{default:l(()=>[a(q,{span:14},{default:l(()=>[Qe,a(c,{class:"mt-12"}),a(b,{label:"Menu name",name:"menuName",required:""},{default:l(()=>[a(_,{value:e(n).menuName,"onUpdate:value":t[0]||(t[0]=m=>e(n).menuName=m)},null,8,["value"])]),_:1}),a(b,{label:"Select parent",name:"parentId",required:""},{default:l(()=>[a(w,{value:e(n).parentId,"onUpdate:value":t[1]||(t[1]=m=>e(n).parentId=m),"field-names":{value:"menuId",label:"menuName"},"tree-data":e(o)},null,8,["value","tree-data"])]),_:1}),a(b,{label:"Menu status",name:"status",required:""},{default:l(()=>[a(k,{value:e(n).status,"onUpdate:value":t[2]||(t[2]=m=>e(n).status=m),options:e(le)},null,8,["value","options"])]),_:1}),a(b,{label:"Visible",name:"visible",required:""},{default:l(()=>[a(k,{value:e(n).visible,"onUpdate:value":t[3]||(t[3]=m=>e(n).visible=m),options:e(se)},null,8,["value","options"])]),_:1}),a(b,{label:"Order",name:"orderNum",required:""},{default:l(()=>[a(J,{class:"w-100",value:e(n).orderNum,"onUpdate:value":t[4]||(t[4]=m=>e(n).orderNum=m)},null,8,["value"])]),_:1})]),_:1}),a(q,{span:10},{default:l(()=>[a(Y,{"active-key":e(n).menuType,"onUpdate:activeKey":t[5]||(t[5]=m=>e(n).menuType=m)},{default:l(()=>[(i(!0),f(T,null,ue(e(H),m=>(i(),v(Q,{key:m.value,tab:m.label},null,8,["tab"]))),128))]),_:1},8,["active-key"]),a(He)]),_:1})]),_:1})]),_:1}),a(X,{justify:"center"})]),_:1},8,["model"])]),_:1},8,["visible"])}}}),Ge=L(Ye,[["__scopeId","data-v-52599c4f"]]),We=[{title:"Menu name",dataIndex:"menuName"},{title:"Order",dataIndex:"orderNum",width:100},{title:"Is frame",dataIndex:"isFrame"},{title:"Menu type",dataIndex:"menuType"},{title:"Component path",dataIndex:"component"}],Xe={class:"menu-head mb-4"},Ze=y("h3",null,"菜单管理",-1),ea={class:"mt-12 flex align-center justify-between"},aa={class:"flex gc-4"},na={class:"flex gc-4 align-center"},ta=h({__name:"MenuHead",setup(s){const d=()=>{R()},o=()=>{Le()};return(x,u)=>{const t=B,c=Ie,_=ke,b=$e,w=E;return i(),f("div",Xe,[a(w,null,{default:l(()=>[Ze,y("div",ea,[y("div",aa,[a(_,{title:"Create"},{default:l(()=>[a(c,{onClick:o,type:"primary"},{icon:l(()=>[a(t)]),_:1})]),_:1}),a(_,{title:"Edit"},{default:l(()=>[a(c,{onClick:d,disabled:e(p).length===0},{default:l(()=>[a(e(be))]),_:1},8,["disabled"])]),_:1}),a(_,{title:"Reload"},{default:l(()=>[a(c,{onClick:e(M)},{default:l(()=>[a(e(xe))]),_:1},8,["onClick"])]),_:1}),a(b,{"allow-clear":"",value:e(C).menuName,"onUpdate:value":u[0]||(u[0]=k=>e(C).menuName=k),placeholder:"Please enter menu name",style:{width:"200px"},onSearch:e(M)},null,8,["value","onSearch"])]),y("div",na,[a(_,{title:"Delete "},{default:l(()=>[a(c,{onClick:u[1]||(u[1]=k=>e(A)()),danger:"",disabled:e(p).length===0},{default:l(()=>[a(e(j))]),_:1},8,["disabled"])]),_:1})])])]),_:1})])}}}),oa={class:"menu-table"},la=h({__name:"MenuTable",setup(s){return Ce(()=>{M()}),(d,o)=>{const x=Te,u=we;return i(),f("div",oa,[a(ta),a(Ke,{table:e($),columns:e(We),query:e(C),"onUpdate:query":o[0]||(o[0]=t=>N(C)?C.value=t:null),form:e(n),"onUpdate:form":o[1]||(o[1]=t=>N(n)?n.value=t:null),"selected-keys":e(p),"onUpdate:selectedKeys":o[2]||(o[2]=t=>N(p)?p.value=t:null)},{default:l(({value:t})=>[t.column.dataIndex==="operation"?(i(),v(De,{key:0,onEdit:c=>e(R)(t.record),items:e(Ee)},null,8,["onEdit","items"])):I("",!0),t.column.dataIndex==="isFrame"?(i(),f(T,{key:1},[t.record.isFrame==="0"?(i(),v(e(Me),{key:0,class:"text-green"})):(i(),v(x,{key:1,class:"text-red"}))],64)):t.column.dataIndex==="menuType"?(i(),v(u,{key:2},{default:l(()=>[F(he(e(Ne)(e(H),t.record.menuType)),1)]),_:2},1024)):I("",!0)]),_:1},8,["table","columns","query","form","selected-keys"])])}}}),sa=L(la,[["__scopeId","data-v-12cf7e5d"]]),ua={class:"system-module"},ca=h({__name:"index",setup(s){return(d,o)=>(i(),f("div",ua,[a(sa),a(Fe,{"enter-active-class":"animate__animated animate__zoomIn","leave-active-class":"animate__animated animate__zoomOut"},{default:l(()=>[e(r)?(i(),v(Ge,{key:0})):I("",!0)]),_:1})]))}});export{ca as default};
