import{b as t,A as de,r as g,g as O,aO as re,h as E,aP as pe,o as d,c as y,w as a,f as v,F as T,k as K,u as e,ag as ve,aG as L,aH as Q,_ as R,q as j,O as G,s as J,v as fe,M as ge,a8 as W,z as be,aC as F,j as $,W as w,i as k,K as Y,J as X,I as Z,B as z,D as ye,m as ke,aa as ee,aE as Ce,$ as Ie,l as M,E as $e,aQ as xe,y as we,P as te,aw as he,aF as Oe,G as Me,H as Ne,C as V,N as Te,Q as Ue,R as Se,U as Fe,aR as qe,t as ze,aS as Ve,aT as Ae,aU as Be,ay as De}from"./index-CH_iqGEu.js";import{g as Pe,d as je,m as He,c as Ee,u as Ke,a as Le}from"./menu-Cp8R9O2C.js";import{_ as Qe}from"./Operation.vue_vue_type_script_setup_true_lang-BNvC77tD.js";import{_ as Re}from"./SystemTable.vue_vue_type_script_setup_true_lang-C-C8cdlw.js";var Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM664 533h-48.1c-4.2 0-7.8 3.2-8.1 7.4C604 589.9 562.5 629 512 629s-92.1-39.1-95.8-88.6c-.3-4.2-3.9-7.4-8.1-7.4H360a8 8 0 00-8 8.4c4.4 84.3 74.5 151.6 160 151.6s155.6-67.3 160-151.6a8 8 0 00-8-8.4z"}}]},name:"smile",theme:"outlined"};const Je=Ge;function H(u){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?Object(arguments[s]):{},m=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(m=m.concat(Object.getOwnPropertySymbols(l).filter(function(_){return Object.getOwnPropertyDescriptor(l,_).enumerable}))),m.forEach(function(_){We(u,_,l[_])})}return u}function We(u,s,l){return s in u?Object.defineProperty(u,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):u[s]=l,u}var A=function(s,l){var m=H({},s,l.attrs);return t(de,H({},m,{icon:Je}),null)};A.displayName="SmileOutlined";A.inheritAttrs=!1;const Ye=A;let q={createTime:"",menuId:0,menuName:"",parentId:0,orderNum:0,path:"",query:"",isFrame:"1",isCache:"1",menuType:"C",visible:"0",status:"0",perms:"",icon:"",children:[]};const n=g({...q}),b=g(!1),ne=()=>{n.value={...q},console.log(q)},Xe={class:"icon-selector"},Ze=["onClick"],et=["src","alt"],tt=O({__name:"IconSelector",props:{modelValue:{}},emits:["update:modelValue"],setup(u,{emit:s}){const l=re("profile/image-icon/"),m=g([]),_=s,i=g("");E(async()=>{const{data:o}=await pe("image-icon");m.value=o.data});const p=o=>{_("update:modelValue",`image-icon/${o}`),i.value=o};return(o,x)=>{const I=L,f=Q;return d(),y("div",Xe,[t(f,null,{default:a(()=>[t(I,{key:"image",tab:"自定义图标",class:"icon-container"},{default:a(()=>[v("ul",null,[(d(!0),y(T,null,K(e(m),(r,S)=>(d(),y("li",{key:S,onClick:B=>p(r),class:ve({active:r===e(i)})},[v("img",{src:e(l)+r,alt:r,width:"32"},null,8,et)],10,Ze))),128))])]),_:1})]),_:1})])}}}),nt=R(tt,[["__scopeId","data-v-eaf9ebb9"]]),at=g(),h=g({rowKey:"menuId",data:[],loading:!1,moduleName:"menu"}),C=g([]),N=g({pageNum:1,pageSize:10,menuName:"",status:"",total:0}),lt=[{label:"添加子目录",key:"create",icon:j(G),onClick(){let u=n.value.menuId;ne(),n.value.parentId=u,console.log(n.value),b.value=!0}},{label:"删除",key:"delete",icon:j(J),onClick(){fe(le,C.value)}}],ae=async u=>{let s=0;u?(s=u.menuId,n.value=u):C.value.length===1&&(s=C.value[0]);const{data:l}=await Pe(s);l.data&&(n.value=l.data),b.value=!b.value},ot=()=>{ne(),b.value=!b.value},le=u=>{ge.confirm({title:"警告",content:"该操作可能影响系统运行",centered:!0,async onOk(){let s="";u?s=u:s=`${C.value[0]}`;try{const{data:l}=await je(s);W.success(l.msg),U()}catch{}}})},U=async()=>{h.value.loading=!0;const{data:u}=await He();u.data&&(h.value.data=Ee(u.data)),h.value.loading=!1},oe=[{label:"文件",value:"C"},{label:"文件夹",value:"M"},{label:"按钮",value:"F"}],st={class:"system__subtitle text-12"},ut={class:"system__subtitle mt-4"},it={class:"system__subtitle mt-4"},_t=v("span",{class:"text-12"},"更多",-1),ct={style:{width:"300px"}},mt=v("div",{class:"system__subtitle"},"关闭窗口后是否缓存数据",-1),dt=O({__name:"Params",setup(u){return(s,l)=>{const m=Y,_=X,i=Z,p=z,o=ye,x=ke,I=ee,f=Ce;return d(),y("div",null,[e(n).menuType==="C"||e(n).menuType==="M"?(d(),y(T,{key:0},[t(_,{label:"是否为链接",name:"isFrame"},{default:a(()=>[t(m,{value:e(n).isFrame,"onUpdate:value":l[0]||(l[0]=r=>e(n).isFrame=r),options:e(be)},null,8,["value","options"])]),_:1}),t(_,{label:e(n).isFrame!=="0"?"路径":"链接",name:"path"},{default:a(()=>[t(i,{value:e(n).path,"onUpdate:value":l[1]||(l[1]=r=>e(n).path=r)},null,8,["value"]),v("div",st,[t(e(F)),$(" 文件夹/文件的唯一标识 ")])]),_:1},8,["label"])],64)):w("",!0),e(n).menuType==="C"||e(n).menuType==="F"?(d(),k(_,{key:1,label:"权限标识",name:"perms"},{default:a(()=>[t(i,{value:e(n).perms,"onUpdate:value":l[2]||(l[2]=r=>e(n).perms=r)},null,8,["value"]),v("div",ut,[t(e(F)),$(" 对按钮级别的控制 ")])]),_:1})):w("",!0),e(n).menuType==="C"?(d(),y(T,{key:2},[t(_,{label:"组件路径",name:"component"},{default:a(()=>[t(i,{value:e(n).component,"onUpdate:value":l[3]||(l[3]=r=>e(n).component=r),placeholder:"请输入组件路径"},null,8,["value"]),v("div",it,[t(e(F)),$(" 对应vue组件的路径 "),t(I,{trigger:"click"},{content:a(()=>[v("div",ct,[t(x,{column:1},{default:a(()=>[t(o,{label:"填写格式"},{default:a(()=>[$("system/test/index")]),_:1}),t(o,{label:"解释"},{default:a(()=>[$(" 将自动读取/views/modules/system/test/index.vue 文件 ")]),_:1})]),_:1})])]),default:a(()=>[t(p,{type:"link"},{default:a(()=>[_t]),_:1})]),_:1})])]),_:1}),t(_,{label:"路由参数",name:"query"},{default:a(()=>[t(i,{value:e(n).query,"onUpdate:value":l[4]||(l[4]=r=>e(n).query=r),placeholder:"请输入路由参数"},null,8,["value"])]),_:1}),t(_,{label:"允许缓存",name:"isCache"},{default:a(()=>[t(f,{"un-checked-value":"1","checked-value":"0",checked:e(n).isCache,"onUpdate:checked":l[5]||(l[5]=r=>e(n).isCache=r)},null,8,["checked"]),mt]),_:1})],64)):w("",!0)])}}}),rt={class:"w-100 h-100 cursor-pointer"},pt=O({__name:"MenuForm",setup(u){const s=g([]),l=g(!1),m=g(!1),_=g([]),i=async()=>{let p="";if(l.value=!0,n.value.menuId){const{data:o}=await Ke(n.value);p=o.msg}else{const{data:o}=await Le(n.value);p=o.msg}l.value=!1,W.success(p),b.value=!b.value,U()};return Ie(at,()=>{s.value=[n.value.parentId],_.value=[{menuId:0,menuName:"主目录",path:""},...h.value.data]},{deep:!0,immediate:!0}),(p,o)=>{const x=z,I=Z,f=X,r=te,S=ee,B=he,D=Y,se=Oe,P=Me,ue=L,ie=Q,_e=Ne,ce=V,me=Te;return d(),k(we,{visible:e(b),"onUpdate:visible":o[10]||(o[10]=c=>M(b)?b.value=c:null),title:"菜单配置"},{default:a(()=>[t(me,{model:e(n),"label-col":{span:8},"wrapper-col":{span:16},"label-align":"left",onFinish:i},{default:a(()=>[t(ce,{class:"flex-1","body-style":{height:"500px",overflowY:"auto"},title:"基础配置"},{extra:a(()=>[t(x,{type:"primary",loading:e(l),htmlType:"submit"},{default:a(()=>[$("保存")]),_:1},8,["loading"])]),default:a(()=>[t(_e,{gutter:16},{default:a(()=>[t(P,{span:14},{default:a(()=>[t(f,{label:"菜单名",name:"menuName",required:""},{default:a(()=>[t(I,{value:e(n).menuName,"onUpdate:value":o[0]||(o[0]=c=>e(n).menuName=c)},null,8,["value"])]),_:1}),t(f,{label:"图标",name:"icon"},{default:a(()=>[t(I,{"allow-clear":"",value:e(n).icon,"onUpdate:value":o[4]||(o[4]=c=>e(n).icon=c)},{addonAfter:a(()=>[t(S,{trigger:"click",placement:"leftBottom",open:e(m),"onUpdate:open":o[3]||(o[3]=c=>M(m)?m.value=c:null)},{content:a(()=>[v("div",null,[t(nt,{"onUpdate:modelValue":[o[1]||(o[1]=c=>m.value=!1),o[2]||(o[2]=c=>e(n).icon=c)],modelValue:e(n).icon},null,8,["modelValue"])])]),default:a(()=>[t(r,{title:"选择图标"},{default:a(()=>[v("div",rt,[t(e(Ye))])]),_:1})]),_:1},8,["open"])]),_:1},8,["value"])]),_:1}),t(f,{label:"选择父级菜单",name:"parentId",required:""},{default:a(()=>[t(B,{value:e(n).parentId,"onUpdate:value":o[5]||(o[5]=c=>e(n).parentId=c),"field-names":{value:"menuId",label:"menuName"},"tree-data":e(_)},null,8,["value","tree-data"])]),_:1}),t(f,{label:"菜单状态",name:"status",required:""},{default:a(()=>[t(D,{value:e(n).status,"onUpdate:value":o[6]||(o[6]=c=>e(n).status=c),options:e($e)},null,8,["value","options"])]),_:1}),t(f,{label:"是否显示",name:"visible",required:""},{default:a(()=>[t(D,{value:e(n).visible,"onUpdate:value":o[7]||(o[7]=c=>e(n).visible=c),options:e(xe)},null,8,["value","options"])]),_:1}),t(f,{label:"排序",name:"orderNum",required:""},{default:a(()=>[t(se,{class:"w-100",value:e(n).orderNum,"onUpdate:value":o[8]||(o[8]=c=>e(n).orderNum=c)},null,8,["value"])]),_:1})]),_:1}),t(P,{span:10},{default:a(()=>[t(ie,{"active-key":e(n).menuType,"onUpdate:activeKey":o[9]||(o[9]=c=>e(n).menuType=c)},{default:a(()=>[(d(!0),y(T,null,K(e(oe),c=>(d(),k(ue,{key:c.value,tab:c.label},null,8,["tab"]))),128))]),_:1},8,["active-key"]),t(dt)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])}}}),vt=[{title:"菜单名",dataIndex:"menuName"},{title:"顺序",dataIndex:"orderNum",width:100},{title:"是否为链接",dataIndex:"isFrame"},{title:"菜单类型",dataIndex:"menuType"},{title:"组件路径",dataIndex:"component"}],ft={class:"menu-head mb-4"},gt=v("h3",null,"菜单管理",-1),bt={class:"mt-12 flex align-center justify-between"},yt={class:"flex gc-4"},kt={class:"flex gc-4 align-center"},Ct=O({__name:"MenuHead",setup(u){const s=()=>{ae()},l=()=>{ot()};return(m,_)=>{const i=G,p=z,o=te,x=Fe,I=V;return d(),y("div",ft,[t(I,{bordered:!1},{default:a(()=>[gt,v("div",bt,[v("div",yt,[t(o,{title:"Create"},{default:a(()=>[t(p,{onClick:l,type:"primary"},{icon:a(()=>[t(i)]),_:1})]),_:1}),t(o,{title:"编辑"},{default:a(()=>[t(p,{onClick:s,disabled:e(C).length===0},{default:a(()=>[t(e(Ue))]),_:1},8,["disabled"])]),_:1}),t(o,{title:"重新加载"},{default:a(()=>[t(p,{onClick:e(U)},{default:a(()=>[t(e(Se))]),_:1},8,["onClick"])]),_:1}),t(x,{"allow-clear":"",value:e(N).menuName,"onUpdate:value":_[0]||(_[0]=f=>e(N).menuName=f),placeholder:"请输入菜单名",style:{width:"200px"},onSearch:e(U)},null,8,["value","onSearch"])]),v("div",kt,[t(o,{title:"Delete "},{default:a(()=>[t(p,{onClick:_[1]||(_[1]=f=>e(le)()),danger:"",disabled:e(C).length===0},{default:a(()=>[t(e(J))]),_:1},8,["disabled"])]),_:1})])])]),_:1})])}}}),It={class:"menu-table"},$t=O({__name:"MenuTable",setup(u){return E(()=>{U()}),(s,l)=>{const m=Ae,_=Be;return d(),y("div",It,[t(Ct),t(Re,{table:e(h),columns:e(vt),query:e(N),"onUpdate:query":l[0]||(l[0]=i=>M(N)?N.value=i:null),form:e(n),"onUpdate:form":l[1]||(l[1]=i=>M(n)?n.value=i:null),"selected-keys":e(C),"onUpdate:selectedKeys":l[2]||(l[2]=i=>M(C)?C.value=i:null)},{default:a(({value:i})=>[i.column.dataIndex==="operation"?(d(),k(Qe,{key:0,loading:e(h).loading,onOnClick:p=>e(ae)(i.record),items:e(lt)},null,8,["loading","onOnClick","items"])):w("",!0),i.column.dataIndex==="isFrame"?(d(),y(T,{key:1},[i.record.isFrame==="0"?(d(),k(e(qe),{key:0,class:"text-green"})):(d(),k(m,{key:1,class:"text-red"}))],64)):i.column.dataIndex==="menuType"?(d(),k(_,{key:2},{default:a(()=>[$(ze(e(Ve)(e(oe),i.record.menuType)),1)]),_:2},1024)):w("",!0)]),_:1},8,["table","columns","query","form","selected-keys"])])}}}),xt=R($t,[["__scopeId","data-v-09a388a8"]]),Nt=O({__name:"index",setup(u){return(s,l)=>{const m=V;return d(),k(m,{class:"system__module"},{default:a(()=>[t(xt),t(De,{"enter-active-class":"animate__animated animate__zoomIn","leave-active-class":"animate__animated animate__zoomOut"},{default:a(()=>[e(b)?(d(),k(pt,{key:0})):w("",!0)]),_:1})]),_:1})}}});export{Nt as default};
