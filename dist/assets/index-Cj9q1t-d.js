import{r as k,a as D,av as Ce,q as X,Q as Z,v as j,s as ee,g as I,o as h,i as $,w as a,b as e,u as t,j as w,B as P,O as _e,R as ae,T as ce,d as J,C as q,h as W,c as T,V as S,l as G,aw as de,f,y as ie,ax as V,E as te,G as ne,I as le,H as pe,_ as Q,as as xe,an as Ie,F as se,k as Ne,ay as $e,az as Ue,ae as Te,aA as De,a2 as me,p as re,e as fe,aB as Fe,aC as Oe,L as Se,P as Be,U as Ee,a0 as Le,aD as Re}from"./index-FS4tF_OB.js";import{_ as ze}from"./SystemTable.vue_vue_type_script_setup_true_lang-Ck_-To2L.js";import{F as ve}from"./Field-BH60NeV4.js";import{C as be,m as Ke,c as je,_ as ye,R as qe,a as Qe}from"./menu-CUyraOKf.js";import{o as Ae}from"./dict-C3fEv_GD.js";import{_ as Ge}from"./Operation.vue_vue_type_script_setup_true_lang-CiedVbK-.js";import"./FilterOutlined-9hy3VxsG.js";const E=k(!1),u=k({tables:[],rows:[],info:{tableId:0,tableName:"",tableComment:"",className:"",tplCategory:"",tplWebType:"",packageName:"",moduleName:"",businessName:"",functionName:"",functionAuthor:"",genType:"",genPath:"",columns:[],sub:!1,tree:!1,crud:!1,createBy:"",createTime:"",updateBy:""}}),K=k(),L=k(!1),oe=k([{title:"函数名",dataIndex:"functionName"},{title:"类名",dataIndex:"className"},{title:"模板分类",dataIndex:"tplCategory"},{title:"模块名",dataIndex:"moduleName"},{title:"业务名",dataIndex:"businessName"}]),Ve=n=>D.get("tool/gen/list",{params:n}),Me=n=>D.get(`tool/gen/${n}`),Pe=n=>D.put("tool/gen",n),Je=n=>D.delete(`tool/gen/${n}`),We=n=>D.get(`tool/gen/synchDb/${n}`),He=n=>D.get("tool/gen/db/list",{params:n}),Ye=n=>D.post(`tool/gen/importTable?tables=${n.join(",")}`),Xe=n=>Ce({url:`tool/gen/batchGenCode?tables=${n.join(",")}`,data:void 0,fileName:`code-${new Date().getTime()}.zip`,method:"GET"}),N=k({rowKey:"tableName",data:[],loading:!1,moduleName:"code"}),U=k({pageNum:1,pageSize:10,total:0,orderByColumn:"create_time",isAsc:"desc"}),C=k([]),Ze=[{label:"同步",key:"edit",icon:X(Z),onClick(){K.value&&j(We,K.value.tableName)}},{label:"删除",key:"delete",icon:X(ee),onClick(){he()}}],B=async()=>{N.value.loading=!0;const{data:n}=await Ve(U.value);N.value.data=n.rows,U.value.total=n.total,N.value.loading=!1},ge=async n=>{N.value.loading=!0;let _=n||C.value[0];const{data:l}=await Me(_);l.data&&(u.value=l.data),N.value.loading=!1,E.value=!0},he=async()=>{var _,l;let n=(_=K.value)!=null&&_.tableId?[(l=K.value)==null?void 0:l.tableId]:C.value;await j(Je,n),B()},R=k({rowKey:"tableName",data:[],loading:!1,moduleName:"db"}),z=k({pageNum:1,pageSize:10,total:0}),A=k([]);X(ee);const M=async()=>{R.value.loading=!0;const{data:n}=await He(z.value);R.value.data=n.rows,z.value.total=n.total,R.value.loading=!1},ke=async n=>{let _=n?[n]:A.value;await j(Ye,_),await B(),L.value=!1},ea=I({__name:"head",setup(n){return(_,l)=>{const o=P,v=Z,s=_e,p=ae,b=ce,d=J,c=q;return h(),$(c,{title:"待导入的列表",class:"mb-8"},{extra:a(()=>[e(o,{onClick:l[0]||(l[0]=i=>t(ke)()),type:"primary"},{default:a(()=>[w("导入")]),_:1})]),default:a(()=>[e(d,{justify:"space-between"},{default:a(()=>[e(d,{gap:4,align:"center"},{default:a(()=>[e(s,{title:"刷新"},{default:a(()=>[e(o,{type:"link",onClick:t(M)},{default:a(()=>[e(v)]),_:1},8,["onClick"])]),_:1}),e(p,{type:"vertical"}),e(b,{"allow-clear":"",onSearch:t(M)},null,8,["onSearch"])]),_:1}),e(d,null,{default:a(()=>[e(ve,{columns:t(oe),"module-name":t(R).moduleName},null,8,["columns","module-name"])]),_:1})]),_:1})]),_:1})}}}),aa=k([{title:"表名称",dataIndex:"tableName"},{title:"表注释",dataIndex:"tableComment"}]),ta=I({__name:"table",setup(n){return W(()=>{M()}),(_,l)=>{const o=de,v=P;return h(),T("div",null,[e(ea),e(ze,{columns:t(aa),table:t(R),query:t(z),"onUpdate:query":l[0]||(l[0]=s=>G(z)?z.value=s:null),"selected-keys":t(A),"onUpdate:selectedKeys":l[1]||(l[1]=s=>G(A)?A.value=s:null),onReload:t(M)},{default:a(({value:s})=>[s.column.dataIndex==="operation"?(h(),$(v,{key:0,type:"text",onClick:p=>t(ke)(s.record.tableName)},{default:a(()=>[e(o)]),_:2},1032,["onClick"])):S("",!0)]),_:1},8,["columns","table","query","selected-keys","onReload"])])}}}),na={class:"h-100 flex flex-col relative"},la=I({__name:"db",setup(n){return(_,l)=>(h(),$(ie,{title:"导入表",visible:t(L),"onUpdate:visible":l[0]||(l[0]=o=>G(L)?L.value=o:null)},{default:a(()=>[f("div",na,[e(ta)])]),_:1},8,["visible"]))}}),oa={key:0},sa={class:"desc mb-12"},ua={class:"desc"},_a={class:"desc"},ca={class:"desc"},da=I({__name:"BackendInfo",setup(n){return(_,l)=>{var i;const o=be,v=V,s=te,p=ne,b=le,d=V,c=pe;return(i=t(u))!=null&&i.info?(h(),T("div",oa,[e(p,null,{default:a(()=>[e(s,{span:8,offset:4},{default:a(()=>[f("h3",null,[e(o),w(" 后端相关配置 ")]),f("div",sa,[e(v),w(" 将会影响代码的目录结构 ")])]),_:1})]),_:1}),e(c,{label:"生成包路径"},{default:a(()=>[e(b,{value:t(u).info.packageName,"onUpdate:value":l[0]||(l[0]=m=>t(u).info.packageName=m)},null,8,["value"]),f("div",ua,[e(d),w(" Java 包的路径 ")])]),_:1}),e(c,{label:"模块名"},{default:a(()=>[e(b,{value:t(u).info.moduleName,"onUpdate:value":l[1]||(l[1]=m=>t(u).info.moduleName=m)},null,8,["value"]),f("div",_a,[e(d),w(" 系统生成3层目录,模块名为第一层 ")])]),_:1}),e(c,{label:"业务名"},{default:a(()=>[e(b,{value:t(u).info.businessName,"onUpdate:value":l[2]||(l[2]=m=>t(u).info.businessName=m)},null,8,["value"]),f("div",ca,[e(d),w(" 业务名为第二层目录 ")])]),_:1}),e(c,{label:"功能名"},{default:a(()=>[e(b,{value:t(u).info.functionName,"onUpdate:value":l[3]||(l[3]=m=>t(u).info.functionName=m)},null,8,["value"])]),_:1})])):S("",!0)}}}),ia=Q(da,[["__scopeId","data-v-2e8934f2"]]),pa=async()=>{const{data:n}=await Ke();if(n.data)return[{menuId:0,menuName:"主页",children:je(n.data)}]},ma={key:0},ra={class:"my-8 text-12 system-subtitle"},fa={class:"text-12 system-subtitle"},va=I({__name:"DatabaseInfo",setup(n){const _=k();return W(async()=>{_.value=await pa()}),(l,o)=>{var O;const v=ye,s=V,p=te,b=ne,d=xe,c=V,i=pe,m=le,x=Ie;return(O=t(u))!=null&&O.info?(h(),T("div",ma,[e(b,null,{default:a(()=>[e(p,{span:8,offset:4},{default:a(()=>[f("h3",null,[e(v),w(" 数据库相关配置 ")]),f("div",ra,[e(s),w(" 对表的基本信息进行配置 ")])]),_:1})]),_:1}),e(i,{label:"上级菜单"},{default:a(()=>[e(d,{value:t(u).info.parentMenuId,"onUpdate:value":o[0]||(o[0]=g=>t(u).info.parentMenuId=g),"field-names":{value:"menuId",label:"menuName"},placeholder:"请选择上级菜单","tree-data":t(_),allowClear:""},null,8,["value","tree-data"]),f("div",fa,[e(c),w(" 将会在数据库中创建菜单 ")])]),_:1}),e(i,{name:"codeFormData.info.tableName",label:"表名"},{default:a(()=>[e(m,{value:t(u).info.tableName,"onUpdate:value":o[1]||(o[1]=g=>t(u).info.tableName=g)},null,8,["value"])]),_:1}),e(i,{name:"tableComment",label:"表描述"},{default:a(()=>[e(m,{value:t(u).info.tableComment,"onUpdate:value":o[2]||(o[2]=g=>t(u).info.tableComment=g)},null,8,["value"])]),_:1}),e(i,{name:"functionAuthor",label:"作者"},{default:a(()=>[e(m,{value:t(u).info.functionAuthor,"onUpdate:value":o[3]||(o[3]=g=>t(u).info.functionAuthor=g)},null,8,["value"])]),_:1}),e(i,{name:"className",label:"实体类名称"},{default:a(()=>[e(m,{value:t(u).info.className,"onUpdate:value":o[4]||(o[4]=g=>t(u).info.className=g)},null,8,["value"])]),_:1}),e(i,{name:"remark",label:"备注"},{default:a(()=>[e(x,{value:t(u).info.remark,"onUpdate:value":o[5]||(o[5]=g=>t(u).info.remark=g)},null,8,["value"])]),_:1})])):S("",!0)}}}),ba=Q(va,[["__scopeId","data-v-5a40ec39"]]),ya=[{title:"字段",dataIndex:"capJavaField"},{title:"键名",dataIndex:"columnComment"},{title:"添加&编辑",dataIndex:"isInsert"},{title:"列表",dataIndex:"isList"},{title:"查询",dataIndex:"isQuery"},{title:"必填",dataIndex:"isRequired"}],ue=[{label:"长整型",value:"Long"},{label:"字符串",value:"String"},{label:"整型",value:"Integer"},{label:"双精度",value:"Double"},{label:"大数",value:"BigDecimal"},{label:"日期",value:"Date"},{label:"布尔",value:"Boolean"}],ga=[{label:"文本框",value:"input"},{label:"文本域",value:"textarea"},{label:"下拉框",value:"select"},{label:"单选框",value:"radio"},{label:"复选框",value:"checkbox"},{label:"日期控件",value:"datetime"},{label:"图片上传",value:"imageUpload"},{label:"文件上传",value:"fileUpload"},{label:"富文本控件",value:"editor"}],ha=[{label:"=",value:"EQ"},{label:"!=",value:"NE"},{label:">",value:"GT"},{label:">=",value:"GTE"},{label:"<",value:"LT"},{label:"<=",value:"LTE"},{label:"LIKE",value:"LIKE"},{label:"BETWEEN",value:"BETWEEN"}],F=n=>(re("data-v-43dab104"),n=n(),fe(),n),ka={key:0},wa=F(()=>f("div",{class:"label"},"字段描述",-1)),Ca=F(()=>f("div",{class:"label"},"查询方式",-1)),xa=F(()=>f("div",{class:"label"},"表单类型",-1)),Ia=F(()=>f("div",{class:"label"},"字段类型",-1)),Na=F(()=>f("div",{class:"label"},"是否主键",-1)),$a=F(()=>f("div",{class:"label"},"字段排序",-1)),Ua=F(()=>f("div",{class:"label"},"下拉选项",-1)),Ta=I({__name:"FieldInfo",setup(n){const _=["isInsert","isEdit","isList","isQuery","isRequired"],l=k(),o=async()=>{const{data:v}=await Ae();v.data&&(l.value=$e(v.data))};return W(()=>{o()}),(v,s)=>{const p=Ue,b=le,d=J,c=te,i=Te,m=ne,x=ae,O=De,g=q,H=me;return t(u).info?(h(),T("div",ka,[e(H,{columns:t(ya),"row-key":"capJavaField",sticky:"","data-source":t(u).info.columns,pagination:{pageSize:20,showLessItems:!0,showQuickJumper:!0}},{bodyCell:a(({column:r,record:y})=>[(h(),T(se,null,Ne(_,Y=>(h(),T(se,null,[Y===r.dataIndex?(h(),$(p,{key:0,"un-checked-value":"0",size:"small",checked:y[Y],"onUpdate:checked":we=>y[Y]=we,"checked-value":"1"},null,8,["checked","onUpdate:checked"])):S("",!0)],64))),64))]),expandedRowRender:a(({record:r})=>[e(g,{bordered:!1,class:"addition"},{default:a(()=>[f("div",null,[e(m,{gutter:12},{default:a(()=>[e(c,{span:7},{default:a(()=>[e(d,null,{default:a(()=>[wa,e(b,{class:"w-100",value:r.columnComment,"onUpdate:value":y=>r.columnComment=y,options:t(ue)},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024),e(c,{span:5},{default:a(()=>[e(d,null,{default:a(()=>[Ca,e(i,{class:"flex-1",value:r.queryType,"onUpdate:value":y=>r.queryType=y,options:t(ha)},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024),e(c,{span:6},{default:a(()=>[e(d,null,{default:a(()=>[xa,e(i,{class:"w-100",value:r.htmlType,"onUpdate:value":y=>r.htmlType=y,options:t(ga)},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024),e(c,{span:6},{default:a(()=>[e(d,null,{default:a(()=>[Ia,e(i,{class:"w-100",value:r.javaType,"onUpdate:value":y=>r.javaType=y,options:t(ue)},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(x,{class:"my-12"}),e(m,{gutter:12},{default:a(()=>[e(c,{span:4},{default:a(()=>[e(d,{algin:"center"},{default:a(()=>[Na,e(p,{"un-checked-value":"0",size:"small",disabled:"",checked:r.isPk,"onUpdate:checked":y=>r.isPk=y,"checked-value":"1"},null,8,["checked","onUpdate:checked"])]),_:2},1024)]),_:2},1024),e(c,{span:6},{default:a(()=>[e(d,{class:"flex"},{default:a(()=>[$a,e(O,{size:"small",class:"w-100",value:r.sort,"onUpdate:value":y=>r.sort=y},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(c,{span:8},{default:a(()=>[e(d,null,{default:a(()=>[Ua,e(i,{class:"w-100",value:r.dictType,"onUpdate:value":y=>r.dictType=y,options:t(l)},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:1},8,["columns","data-source"])])):S("",!0)}}}),Da=Q(Ta,[["__scopeId","data-v-43dab104"]]),Fa=n=>(re("data-v-07034ace"),n=n(),fe(),n),Oa=Fa(()=>f("div",null,"生成代码配置",-1)),Sa={class:"flex-1 p-8"},Ba=I({__name:"form",setup(n){const _=k(!1),l=async()=>{_.value=!0,await j(Pe,u.value.info),E.value=!1,_.value=!1};return(o,v)=>{const s=P,p=J,b=q,d=ye,c=Fe,i=Oe,m=Se;return h(),$(m,{model:t(u).info,"wrapper-col":{span:8},"label-col":{span:4},onFinish:l},{default:a(()=>[e(ie,{title:"生成信息编辑",visible:t(E),"onUpdate:visible":v[0]||(v[0]=x=>G(E)?E.value=x:null),w:"95%",h:"95%"},{default:a(()=>[e(b,{class:"card-head"},{default:a(()=>[e(p,{justify:"space-between"},{default:a(()=>[Oa,e(s,{type:"primary",loading:t(_),htmlType:"submit"},{default:a(()=>[w("保存")]),_:1},8,["loading"])]),_:1})]),_:1}),e(b,{class:"mt-12"},{default:a(()=>[e(p,{class:"h-100",style:{overflow:"hidden"}},{default:a(()=>[f("div",Sa,[e(i,{"tab-position":"left",class:"h-100"},{default:a(()=>[e(c,{key:"base-info"},{tab:a(()=>[e(d),w(" SQL配置 ")]),default:a(()=>[e(ba)]),_:1}),e(c,{key:"generate-info"},{tab:a(()=>[e(t(be)),w(" 后端配置 ")]),default:a(()=>[e(ia)]),_:1}),e(c,{key:"field-info"},{tab:a(()=>[e(t(qe)),w(" 字段配置 ")]),default:a(()=>[e(Da)]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1},8,["model"])}}}),Ea=Q(Ba,[["__scopeId","data-v-07034ace"]]),La=I({__name:"head",setup(n){const _=()=>{j(Xe,C.value)};return(l,o)=>{const v=Qe,s=P,p=_e,b=de,d=Be,c=Z,i=ae,m=ce,x=J,O=ee,g=Ee,H=q;return h(),$(H,{class:"table__head mb-8",title:"数据库列表"},{default:a(()=>[e(x,{justify:"space-between"},{default:a(()=>[e(x,{justify:"center"},{default:a(()=>[e(x,{gap:4,justify:"space-between",align:"center"},{default:a(()=>[e(p,{title:"导入数据库"},{default:a(()=>[e(s,{onClick:o[0]||(o[0]=r=>L.value=!0),type:"primary"},{default:a(()=>[e(v),w(" 导入 ")]),_:1})]),_:1}),e(p,{title:"下载代码"},{default:a(()=>[e(s,{type:"link",onClick:_,disabled:t(C).length!==1},{default:a(()=>[e(b)]),_:1},8,["disabled"])]),_:1}),e(p,{title:"编辑"},{default:a(()=>[e(s,{type:"link",onClick:o[1]||(o[1]=r=>t(ge)()),disabled:t(C).length!==1},{default:a(()=>[e(d)]),_:1},8,["disabled"])]),_:1}),e(p,{title:"刷新"},{default:a(()=>[e(s,{type:"link",onClick:t(B)},{default:a(()=>[e(c)]),_:1},8,["onClick"])]),_:1}),e(i,{type:"vertical"}),e(m,{"allow-clear":"",onSearch:t(B)},null,8,["onSearch"])]),_:1})]),_:1}),e(x,null,{default:a(()=>[e(g,{title:"确定要删除吗",placement:"bottomRight",onConfirm:o[2]||(o[2]=r=>t(he)()),disabled:t(C).length===0},{default:a(()=>[e(s,{danger:"",type:"link",disabled:t(C).length===0},{default:a(()=>[e(O)]),_:1},8,["disabled"])]),_:1},8,["disabled"]),e(ve,{columns:t(oe),"module-name":t(N).moduleName},null,8,["columns","module-name"])]),_:1})]),_:1})]),_:1})}}}),Ra=I({__name:"table",setup(n){const _=s=>{K.value=s},l=s=>{U.value.pageNum=s.current,U.value.pageSize=s.pageSize,B()},o=s=>{C.value=s},v=s=>({onClick(){C.value.includes(s.tableName)?C.value=Re(C.value,p=>p!==s.tableName).value:C.value.push(s.tableName)}});return W(()=>{B()}),(s,p)=>{const b=me;return h(),T("div",null,[e(La),e(b,{onChange:l,"table-layout":"fixed",sticky:"",pagination:{pageSize:t(U).pageSize,current:t(U).pageNum,total:t(U).total},"row-selection":{selectedRowKeys:t(C),onChange:o},"custom-row":v,rowKey:t(N).rowKey,columns:t(Le)(t(oe)),"data-source":t(N).data},{bodyCell:a(({column:d,record:c})=>[d.dataIndex==="operation"?(h(),$(Ge,{key:0,loading:t(N).loading,onOpenChange:i=>_(c),onOnClick:i=>t(ge)(c.tableId),items:t(Ze)},null,8,["loading","onOpenChange","onOnClick","items"])):S("",!0)]),_:1},8,["pagination","row-selection","rowKey","columns","data-source"])])}}}),za=I({__name:"index",setup(n){return(_,l)=>{const o=q;return h(),$(o,{"body-style":{overflowY:"hidden"},class:"system__module"},{default:a(()=>[e(Ra),e(Ea),e(la)]),_:1})}}}),Ma=Q(za,[["__scopeId","data-v-64c0fdfb"]]);export{Ma as default};
