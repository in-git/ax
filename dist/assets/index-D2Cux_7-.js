import{a,A as Y,g as A,r as _,N as ee,P as x,d as U,o as g,c as y,w as c,f as p,u as t,e as w,K as G,a2 as ye,y as te,x as N,i as F,S as P,an as Ie,s as ae,B as ne,m as le,a3 as he,_ as M,v as se,p as be,W as oe,j as Ce,l as ke,q as ce,n as Se,I as j,J as V,z as Ee,C as W,aH as Qe,G as we,a1 as re,am as Be,L as ue,ai as ie,at as Oe,ak as xe,R as Ue,aw as de,ag as Re,al as De,aI as Je,ah as Me,F as pe,Q as Fe,aJ as Te}from"./index-HxNFWFwR.js";import Ke from"./role-9JDBhlCW.js";import{_ as ze}from"./TableHead-D-Q4jVMf.js";import{_ as me}from"./FormFooter-5NEaOLHv.js";var Ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 680h-54V540H546v-92h238c8.8 0 16-7.2 16-16V168c0-8.8-7.2-16-16-16H240c-8.8 0-16 7.2-16 16v264c0 8.8 7.2 16 16 16h238v92H190v140h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8zM256 805.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zm288 0c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM288 384V216h448v168H288zm544 421.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM360 300a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"cluster",theme:"outlined"};const Ne=Ye;function X(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(o).filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable}))),r.forEach(function(u){Pe(e,u,o[u])})}return e}function Pe(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var H=function(n,o){var r=X({},n,o.attrs);return a(Y,X({},r,{icon:Ne}),null)};H.displayName="ClusterOutlined";H.inheritAttrs=!1;const je=H;var Ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"};const He=Ve;function q(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(o).filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable}))),r.forEach(function(u){Le(e,u,o[u])})}return e}function Le(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var L=function(n,o){var r=q({},n,o.attrs);return a(Y,q({},r,{icon:He}),null)};L.displayName="UserAddOutlined";L.inheritAttrs=!1;const Ze=L;var Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 655.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 518 759.6 444.7 759.6 362c0-137-110.8-248-247.5-248S264.7 225 264.7 362c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 901.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 641.2 432.2 610 512.2 610c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 534c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 362c0-45.9 17.9-89.1 50.3-121.6S466.3 190 512.2 190s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 362c0 45.9-17.9 89.1-50.3 121.6C601.1 516.1 558 534 512.2 534zM880 772H640c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h240c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-delete",theme:"outlined"};const We=Ge;function $(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},r=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(o).filter(function(u){return Object.getOwnPropertyDescriptor(o,u).enumerable}))),r.forEach(function(u){Xe(e,u,o[u])})}return e}function Xe(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var Z=function(n,o){var r=$({},n,o.attrs);return a(Y,$({},r,{icon:We}),null)};Z.displayName="UserDeleteOutlined";Z.inheritAttrs=!1;const qe=Z,$e="/assets/assign-CjzmHGEk.png",et=[{title:"Username",dataIndex:"userName"},{title:"Nickname",dataIndex:"nickName"},{title:"Email",dataIndex:"email"},{title:"Remark",dataIndex:"remark"}],tt=e=>A.get("system/role/list",{params:e}),at=e=>A.get(`system/menu/roleMenuTreeselect/${e}`),nt=()=>A.get("system/menu/treeselect"),lt=e=>A.get(`system/role/deptTree/${e}`),st=e=>A.put("system/role/dataScope",e),ot=e=>A.put("system/role",e),ct=e=>A.post("system/role",e),rt=e=>A.delete(`system/role/${e}`),ut=e=>A.get("system/role/authUser/allocatedList",{params:e}),it=e=>A.get("system/role/authUser/unallocatedList",{params:e}),dt=(e,n)=>A.put("system/role/authUser/cancel",{roleId:e,userId:n}),pt=(e,n)=>A.put("system/role/authUser/selectAll",{roleId:e,userId:n}),K=_(!0),h=_({data:[],roleMenus:[],deptList:[]}),z=_({pageNum:1,pageSize:10,roleName:"",total:0}),l=_(),mt={roleId:0,roleName:"",roleKey:"",roleSort:0,dataScope:"",menuCheckStrictly:!1,deptCheckStrictly:!1,status:"0",flag:!1,menuIds:[],admin:!1},B=_(!1),_t=async()=>{if(l.value){T.value=!0,I.value.roleId=l.value.roleId;const{data:e}=await ut(I.value);J.value.data=e.rows,I.value.total=e.total,T.value=!1,B.value=!0,D.value={title:"已分配用户",mode:"assign"}}},vt=async()=>{if(!l.value)return;I.value.roleId=l.value.roleId;const{data:e}=await it(I.value);B.value=!0,J.value.data=e.rows,I.value.total=e.total,T.value=!1,D.value={title:"取消分配",mode:"unassign"}},T=_(!1),J=_({data:[],selectedKeys:[]}),I=_({pageNum:1,pageSize:10,total:0,roleId:void 0}),gt=e=>{J.value.selectedKeys=e.map(n=>Number(n))},D=_({title:"",mode:""}),ft=e=>{ee.confirm({title:"Warning",content:"该操作可能影响系统运行",async onOk(){if(!l.value)return;const{data:n}=await dt(l.value.roleId,e);x.success(n)},centered:!0})},At=async e=>{if(!l.value)return;const{data:n}=await pt(l.value.roleId,e);x.success(n)},yt="/assets/unassign-C6xwt97d.png",It={class:"py-8 px-12 flex justify-between"},ht={class:"user-list p-8"},bt=["src"],Ct=["src"],kt=U({__name:"RoleAssign",setup(e){return(n,o)=>{const r=Ie,u=ae,m=ne,s=le,i=he;return g(),y("div",null,[a(P,{w:"90%",h:"90%",visible:t(B),"onUpdate:visible":[o[0]||(o[0]=d=>F(B)?B.value=d:null),o[1]||(o[1]=d=>B.value=!1)],title:"Role config"},{default:c(()=>[p("div",null,[a(r,{title:t(D).title,class:"py-0 page-border px-12"},null,8,["title"]),p("div",It,[p("div",null,[a(u,{placeholder:"Please enter name"})]),t(D).mode==="unassign"?(g(),w(m,{key:0,type:"primary",danger:""},{default:c(()=>[G("批量授权")]),_:1})):(g(),w(m,{key:1,type:"primary",danger:""},{default:c(()=>[G("批量取消")]),_:1}))]),p("div",ht,[a(i,{columns:t(ye)(t(et)),loading:t(T),"data-source":t(J).data,pagination:{total:t(I).total,current:t(I).pageNum,pageSize:t(I).pageSize},"row-selection":{selectedRowKeys:t(J).selectedKeys,onChange:t(gt)},"row-key":"userId"},{bodyCell:c(({column:d,record:b})=>[d.dataIndex==="operation"?(g(),y(te,{key:0},[t(D).mode==="unassign"?(g(),w(s,{key:0,title:"取消授权"},{default:c(()=>[a(m,{type:"link",style:{color:"#fc6d6d"},onClick:k=>t(ft)(b.userId)},{default:c(()=>[p("img",{src:t(yt),width:"16",height:"16"},null,8,bt)]),_:2},1032,["onClick"])]),_:2},1024)):(g(),w(s,{key:1,title:"授权"},{default:c(()=>[a(m,{type:"link",style:{color:"#fc6d6d"},onClick:k=>t(At)(b.userId)},{default:c(()=>[p("img",{src:t($e),width:"16",height:"16"},null,8,Ct)]),_:2},1032,["onClick"])]),_:2},1024))],64)):N("",!0)]),_:1},8,["columns","loading","data-source","pagination","row-selection"])])])]),_:1},8,["visible"])])}}}),St=M(kt,[["__scopeId","data-v-ca90fa0b"]]),Et="data:image/png;base64,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",Qt="/assets/role-ByePIYnt.png",wt="/assets/users-BXJH_1Yg.png",C=_(!1);_([{value:"info",payload:{title:"Info",image:Qt}},{value:"resource",payload:{title:"Resource",image:Et}},{value:"users",payload:{title:"User",image:wt}}]);const _e=async e=>{let n=0;e?n=e:l.value&&(n=l.value.roleId);const{data:o}=await at(n);l.value&&(h.value.roleMenus=o.menus,l.value.menuIds=o.checkedKeys),C.value=!0},Bt=async e=>{if(l.value){const{data:n}=await lt(e);h.value.deptList=n.depts,l.value.deptIds=n.checkedKeys}},O=async()=>{K.value=!0;const{data:e}=await tt(z.value);h.value.data=e.rows,K.value=!1},Ot=()=>{ee.confirm({centered:!0,async onOk(){var e;if(l.value&&l.value.roleId){const{data:n}=await rt((e=l.value)==null?void 0:e.roleId);await O(),x.success(n.msg)}},title:"Warning",content:"This could have an impact on your system"})},ve=()=>{l.value={...mt}},Q=_(!1),xt=async()=>{l.value&&(await Bt(l.value.roleId),Q.value=!0)},Ut=e=>(j("data-v-939362d7"),e=e(),V(),e),Rt={class:"flex gc-4 align-center"},Dt=Ut(()=>p("span",{class:"text-999"},"编辑/权限:",-1)),Jt=U({__name:"CardHead",setup(e){const n=async()=>{const{data:r}=await nt();r.data&&(h.value.roleMenus=r.data),C.value=!0,ve()};se(async()=>{await O()});const o=()=>!(l.value&&l.value.roleId);return(r,u)=>{const m=ke,s=ne,i=le,d=ae,b=ce,k=Se,R=Ze,S=ze;return g(),y("div",null,[a(S,{title:"Role list"},{default:c(()=>[p("div",Rt,[a(s,{type:"primary",onClick:n},{default:c(()=>[a(m)]),_:1}),a(i,{title:"Reload"},{default:c(()=>[a(s,{type:"link",onClick:t(O)},{default:c(()=>[a(t(be))]),_:1},8,["onClick"])]),_:1}),a(d,{placeholder:"Please enter role name",value:t(z).roleName,"onUpdate:value":u[0]||(u[0]=E=>t(z).roleName=E),onSearch:t(O),"allow-clear":""},null,8,["value","onSearch"]),a(b,{type:"vertical"}),p("div",{class:oe(["flex gc-2 text-nowrap align-center",[o()?"gray":"active"]])},[Dt,a(i,{title:"编辑基础信息"},{default:c(()=>[a(s,{type:"text",onClick:u[1]||(u[1]=E=>t(_e)()),disabled:!t(l)},{default:c(()=>[a(k,{class:"icon"})]),_:1},8,["disabled"])]),_:1}),a(i,{title:"分配资源",onClick:t(xt)},{default:c(()=>[a(s,{type:"text",disabled:!t(l)},{default:c(()=>[a(t(je),{class:"icon"})]),_:1},8,["disabled"])]),_:1},8,["onClick"]),a(i,{title:"分配人员"},{default:c(()=>[a(s,{type:"text",disabled:!t(l),onClick:t(_t)},{default:c(()=>[a(R,{class:"icon"})]),_:1},8,["disabled","onClick"])]),_:1}),a(i,{title:"取消分配"},{default:c(()=>[a(s,{type:"text",disabled:!t(l),onClick:t(vt)},{default:c(()=>[a(t(qe),{class:"text-danger"})]),_:1},8,["disabled","onClick"])]),_:1})],2)]),p("div",null,[a(s,{type:"link",danger:"",onClick:t(Ot),disabled:o()},{default:c(()=>[a(t(Ce))]),_:1},8,["onClick","disabled"])])]),_:1})])}}}),Mt=M(Jt,[["__scopeId","data-v-939362d7"]]),Ft=e=>(j("data-v-b4a3a7d2"),e=e(),V(),e),Tt={class:"role-card"},Kt={class:"card-list"},zt=["onClick","onDblclick"],Yt=["src"],Nt={class:"text-14"},Pt={class:"desc mt-8 text-12"},jt=Ft(()=>p("span",{class:"text-999 text-12"},"No more",-1)),Vt=U({__name:"RoleCard",setup(e){const n=o=>{l.value=Qe(o).cloned.value};return se(async()=>{await O()}),(o,r)=>{const u=we,m=ce;return g(),y("div",Tt,[a(Mt),p("div",Kt,[a(u,{spinning:t(K)},{default:c(()=>[p("ul",null,[(g(!0),y(te,null,Ee(t(h).data,s=>{var i;return g(),y("li",{class:oe([{active:((i=t(l))==null?void 0:i.roleId)===s.roleId},"text-center"]),onClick:d=>n(s),onDblclick:d=>t(_e)(s.roleId)},[p("img",{src:t(Ke),width:"32",height:"32"},null,8,Yt),p("div",null,[p("div",Nt,W(s.roleName),1),p("div",Pt,W(s.remark),1)])],42,zt)}),256))])]),_:1},8,["spinning"]),a(m,{dashed:""},{default:c(()=>[jt]),_:1})])])}}}),Ht=M(Vt,[["__scopeId","data-v-b4a3a7d2"]]),Lt=e=>(j("data-v-93766deb"),e=e(),V(),e),Zt={key:0,class:"h-100 flex flex-col"},Gt={class:"flex-1"},Wt={class:"flex align-center mb-8"},Xt=Lt(()=>p("span",{class:"text-12 text-999 mr-4"},"父子关联",-1)),qt=U({__name:"RoleInfo",setup(e){const n=_([]),o=_(),r=_(!1),u=async()=>{if(l.value){let m=l.value.menuIds;const s=o.value.halfCheckedKeys;let i=[];if(m.checked?i=m.checked.concat(m.halfCheckedKeys||[]):i=l.value.menuIds,s&&s.length>0&&(i=i.concat(s)),i=Array.from(new Set(i)),l.value.roleId){const{data:d}=await ot({...l.value,menuIds:i});x.success(d.msg)}else{const{data:d}=await ct(l.value);x.success(d.msg)}await O(),ve(),C.value=!1}};return re(h,()=>{n.value=h.value.roleMenus},{deep:!0,immediate:!0}),(m,s)=>{const i=ue,d=ie,b=Oe,k=xe,R=Ue,S=de,E=Re,f=De,ge=Je,fe=Me,Ae=pe;return g(),w(Ae,{model:t(l),onFinish:u,layout:"vertical"},{default:c(()=>[a(P,{w:"90%",h:"90%",visible:t(C),"onUpdate:visible":[s[7]||(s[7]=v=>F(C)?C.value=v:null),s[8]||(s[8]=v=>C.value=!1)],title:"Role config"},{default:c(()=>[t(C)&&t(l)?(g(),y("div",Zt,[p("div",Gt,[a(fe,null,{default:c(()=>[a(E,{span:12},{default:c(()=>[a(S,{bordered:!1},{default:c(()=>[a(d,{label:"Role name",name:"roleName",required:""},{default:c(()=>[a(i,{value:t(l).roleName,"onUpdate:value":s[0]||(s[0]=v=>t(l).roleName=v)},null,8,["value"])]),_:1}),a(d,{label:"Sort",name:"roleSort",required:""},{default:c(()=>[a(b,{class:"w-100",value:t(l).roleSort,"onUpdate:value":s[1]||(s[1]=v=>t(l).roleSort=v)},null,8,["value"])]),_:1}),a(d,{label:"Perms",name:"roleKey",required:""},{default:c(()=>[a(i,{class:"w-100",value:t(l).roleKey,"onUpdate:value":s[2]||(s[2]=v=>t(l).roleKey=v)},null,8,["value"])]),_:1}),a(d,{label:"Role mark",name:"remark"},{default:c(()=>[a(k,{autoSize:{minRows:2,maxRows:4},value:t(l).remark,"onUpdate:value":s[3]||(s[3]=v=>t(l).remark=v)},null,8,["value"])]),_:1}),a(d,{label:"Status"},{default:c(()=>[a(R,{options:t(Be),value:t(l).status,"onUpdate:value":s[4]||(s[4]=v=>t(l).status=v)},null,8,["options","value"])]),_:1})]),_:1})]),_:1}),a(E,{span:12},{default:c(()=>[a(S,{class:"mt-8",bordered:!1},{default:c(()=>[a(d,{label:"分配菜单","label-col":{span:24}},{default:c(()=>[p("div",Wt,[Xt,a(f,{checked:t(r),"onUpdate:checked":s[5]||(s[5]=v=>F(r)?r.value=v:null)},null,8,["checked"])]),a(S,{"body-style":{height:"370px",overflowY:"auto"}},{default:c(()=>[a(ge,{treeData:t(n),checkable:"","block-node":"",selectable:!1,"checked-keys":t(l).menuIds,"onUpdate:checkedKeys":s[6]||(s[6]=v=>t(l).menuIds=v),fieldNames:{key:"id",title:"label"},"default-expand-parent":"","check-strictly":!t(r),ref_key:"treeRef",ref:o},null,8,["treeData","checked-keys","check-strictly"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),a(me,{class:"px-12"})])):N("",!0)]),_:1},8,["visible"])]),_:1},8,["model"])}}}),$t=M(qt,[["__scopeId","data-v-93766deb"]]),ea={key:0,class:"h-100 flex flex-col"},ta=U({__name:"RoleResource",setup(e){const n=_(),o=_(),r=async()=>{if(!l.value)return;const m=l.value.deptIds;l.value.deptIds instanceof Array||(l.value.deptIds=m.checked.concat(m.halfChecked));const{data:s}=await st(l.value);x.success(s.msg)},u=[{value:"1",label:"全部数据权限"},{value:"2",label:"自定数据权限"},{value:"3",label:"本部门数据权限"},{value:"4",label:"本部门及以下数据权限"},{value:"5",label:"仅本人数据权限"}];return re(h,()=>{n.value=h.value.deptList},{deep:!0,immediate:!0}),(m,s)=>{const i=ue,d=ie,b=Fe,k=Te,R=de,S=me,E=pe;return g(),w(E,{model:t(l),onFinish:r,"wrapper-col":{span:8},"label-col":{span:4}},{default:c(()=>[a(P,{w:"90%",h:"90%",visible:t(Q),"onUpdate:visible":[s[4]||(s[4]=f=>F(Q)?Q.value=f:null),s[5]||(s[5]=f=>Q.value=!1)],title:"Role config"},{default:c(()=>[t(Q)&&t(l)?(g(),y("div",ea,[a(R,{title:"Select Department","body-style":{maxHeight:"430px",overflowY:"auto"},class:"flex-1 p-8"},{default:c(()=>[a(d,{label:"Role name",name:"roleName",required:""},{default:c(()=>[a(i,{value:t(l).roleName,"onUpdate:value":s[0]||(s[0]=f=>t(l).roleName=f),disabled:""},null,8,["value"])]),_:1}),a(d,{label:"Role perms",name:"roleKey",required:""},{default:c(()=>[a(i,{value:t(l).roleKey,"onUpdate:value":s[1]||(s[1]=f=>t(l).roleKey=f),disabled:""},null,8,["value"])]),_:1}),a(d,{label:"Scoped",name:"dataScope",required:""},{default:c(()=>[a(b,{value:t(l).dataScope,"onUpdate:value":s[2]||(s[2]=f=>t(l).dataScope=f),options:u},null,8,["value"])]),_:1}),a(d,{name:"deptIds",required:"",label:"Select department"},{default:c(()=>[a(k,{"tree-data":t(n),"field-names":{key:"id",title:"label"},selectable:"","selected-keys":t(l).deptIds,"onUpdate:selectedKeys":s[3]||(s[3]=f=>t(l).deptIds=f),ref_key:"treeRef",ref:o},null,8,["tree-data","selected-keys"])]),_:1})]),_:1}),a(S)])):N("",!0)]),_:1},8,["visible"])]),_:1},8,["model"])}}}),aa={class:"role system-module flex"},na=U({__name:"index",setup(e){return(n,o)=>(g(),y("div",aa,[a(Ht),a($t),a(ta),a(St)]))}}),ra=M(na,[["__scopeId","data-v-9d35c370"]]);export{ra as default};
