import{b as e,A as D,a as O,r as p,q as U,s as V,v as P,x as L,g as k,h as B,o as y,i as I,w as a,y as H,u as n,l as j,f as m,z as J,E as M,j as A,G as K,H as Q,I as W,J as X,K as Y,L as Z,B as E,N as ee,p as te,e as ne,_ as oe,O as ae,P as le,Q as se,R as ue,T as ie,U as re,V as _e,c as de,W as ce,C as pe}from"./index-JuZA7c1I.js";import{g as me}from"./dict.data-Do9LERxg.js";import{_ as fe}from"./SystemTable.vue_vue_type_script_setup_true_lang-CcglCmXY.js";import{_ as be}from"./TableHead-BnO_5gk3.js";import{F as ve}from"./Field-B8FVvODn.js";import{_ as ge}from"./Operation.vue_vue_type_script_setup_true_lang-CC3vq2u4.js";var ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M442.3 677.6l199.4-156.7a11.3 11.3 0 000-17.7L442.3 346.4c-7.4-5.8-18.3-.6-18.3 8.8v313.5c0 9.4 10.9 14.7 18.3 8.9z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"play-square",theme:"outlined"};const je=ye;function q(o){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?Object(arguments[i]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),s.forEach(function(r){xe(o,r,t[r])})}return o}function xe(o,i,t){return i in o?Object.defineProperty(o,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[i]=t,o}var h=function(i,t){var s=q({},i,t.attrs);return e(D,q({},s,{icon:je}),null)};h.displayName="PlaySquareOutlined";h.inheritAttrs=!1;const Oe=h,ke=o=>O.get("monitor/job/list",{params:o}),Ie=o=>O.delete(`monitor/job/${o.join(",")}`),$e=o=>O.put("monitor/job/run",{data:o}),Ce=o=>O.get(`monitor/job/${o}`),b=p(!1),G={createBy:"",createTime:"",remark:"",jobId:0,jobName:"",jobGroup:"",invokeTarget:"",cronExpression:"",misfirePolicy:"",concurrent:"",status:"",nextValidTime:""},l=p({...G}),we=()=>{l.value={...G}},Pe=[{label:"默认策略",value:"0"},{label:"立即执行",value:"1"},{label:"执行一次",value:"2"},{label:"放弃执行",value:"3"}],S=p([]),v=p({rowKey:"jobId",data:[],loading:!1,moduleName:"job"}),g=p({pageNum:1,pageSize:10,total:0}),c=p([]),Se=[{label:"删除",key:"delete",icon:U(V),onClick(){P(N)}},{label:"执行一次",key:"run",icon:U(Oe),onClick(){l.value.jobId&&P($e,{jobGroup:l.value.jobGroup,jobId:l.value.jobId})}}],x=async()=>{v.value.loading=!0;const{data:o}=await ke(g.value);v.value.data=o.rows,g.value.total=o.total,v.value.loading=!1},F=async()=>{const{data:o}=await Ce(l.value.jobId);o.data&&(l.value=o.data,b.value=!0)},Ne=async()=>{we(),b.value=!0},N=async o=>{let i=o?[o]:c.value;await P(Ie,i),x()},he=async()=>{const{data:o}=await me("sys_job_group");o.data&&(S.value=L(o.data))},Te=o=>(te("data-v-59e9b597"),o=o(),ne(),o),Ue={class:"h-100 flex flex-col"},qe=Te(()=>m("h3",null,"定时任务编辑",-1)),Ve={class:"flex-1 p-8"},Be=k({__name:"form",setup(o){return B(async()=>{await he(),console.log(S.value)}),(i,t)=>{const s=K,r=Q,d=W,_=X,f=Y,$=Z,C=E,w=ee;return y(),I(w,{model:n(l),"wrapper-col":{span:8},"label-col":{span:4}},{default:a(()=>[e(H,{title:"定时任务表单",visible:n(b),"onUpdate:visible":t[7]||(t[7]=u=>j(b)?b.value=u:null)},{default:a(()=>[m("div",Ue,[e(r,null,{default:a(()=>[e(s,{span:8,offset:4},{default:a(()=>[qe]),_:1})]),_:1}),m("div",Ve,[e(_,{label:"任务名称"},{default:a(()=>[e(d,{placeholder:"请输入任务名称",value:n(l).jobName,"onUpdate:value":t[0]||(t[0]=u=>n(l).jobName=u)},null,8,["value"])]),_:1}),e(_,{label:"任务分组"},{default:a(()=>[e(f,{value:n(l).jobGroup,"onUpdate:value":t[1]||(t[1]=u=>n(l).jobGroup=u),options:n(S)},null,8,["value","options"])]),_:1}),e(_,{label:"调用方法"},{default:a(()=>[e(d,{placeholder:"调用方法",value:n(l).invokeTarget,"onUpdate:value":t[2]||(t[2]=u=>n(l).invokeTarget=u)},null,8,["value"])]),_:1}),e(_,{label:"表达式"},{default:a(()=>[e(d,{placeholder:"表达式",value:n(l).cronExpression,"onUpdate:value":t[3]||(t[3]=u=>n(l).cronExpression=u)},null,8,["value"])]),_:1}),e(_,{label:"执行策略"},{default:a(()=>[e($,{value:n(l).misfirePolicy,"onUpdate:value":t[4]||(t[4]=u=>n(l).misfirePolicy=u),options:n(Pe)},null,8,["value","options"])]),_:1}),e(_,{label:"是否并发"},{default:a(()=>[e(f,{options:n(J),value:n(l).concurrent,"onUpdate:value":t[5]||(t[5]=u=>n(l).concurrent=u)},null,8,["options","value"])]),_:1}),e(_,{label:"状态"},{default:a(()=>[e(f,{options:n(M),value:n(l).status,"onUpdate:value":t[6]||(t[6]=u=>n(l).status=u)},null,8,["options","value"])]),_:1}),e(r,null,{default:a(()=>[e(s,{span:8,offset:4},{default:a(()=>[e(C,{type:"primary","html-type":"submit"},{default:a(()=>[A("保存")]),_:1})]),_:1})]),_:1})])])]),_:1},8,["visible"])]),_:1},8,["model"])}}}),Ee=oe(Be,[["__scopeId","data-v-59e9b597"]]),R=p([{title:"任务名称",dataIndex:"jobName"},{title:"备注",dataIndex:"remark"},{title:"任务分组",dataIndex:"jobGroup"},{title:"调用目标",dataIndex:"invokeTarget"},{title:"CRON表达式",dataIndex:"cronExpression"},{title:"错失策略",dataIndex:"misfirePolicy"},{title:"并发",dataIndex:"concurrent"},{title:"状态",dataIndex:"status"},{title:"下次有效时间",dataIndex:"nextValidTime"}]),Ge={class:"flex justify-between"},Fe={class:"flex gc-4 align-center"},Re={class:"flex"},ze=k({__name:"head",setup(o){return(i,t)=>{const s=ae,r=E,d=le,_=se,f=ue,$=ie,C=re,w=V,u=_e,z=be;return y(),I(z,{title:"定时任务列表"},{default:a(()=>[m("div",Ge,[m("div",Fe,[e(d,{title:"新建"},{default:a(()=>[e(r,{type:"primary",onClick:n(Ne)},{default:a(()=>[e(s)]),_:1},8,["onClick"])]),_:1}),e(d,{title:"编辑"},{default:a(()=>[e(r,{type:"link",onClick:t[0]||(t[0]=T=>n(F)()),disabled:n(c).length!==1},{default:a(()=>[e(_)]),_:1},8,["disabled"])]),_:1}),e(d,{title:"刷新"},{default:a(()=>[e(r,{type:"link",onClick:n(x)},{default:a(()=>[e(f)]),_:1},8,["onClick"])]),_:1}),e($,{type:"vertical"}),e(C,{"allow-clear":"",onSearch:n(x)},null,8,["onSearch"])])]),m("div",Re,[e(u,{title:"确定要删除吗",placement:"bottomRight",onConfirm:t[2]||(t[2]=T=>n(N)()),disabled:n(c).length===0},{default:a(()=>[e(u,{title:"确定要删除吗",placement:"bottomRight",onConfirm:t[1]||(t[1]=T=>n(N)())},{default:a(()=>[e(d,{title:"批量删除"},{default:a(()=>[e(r,{danger:"",type:"link",disabled:n(c).length===0},{default:a(()=>[e(w)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["disabled"]),e(ve,{columns:n(R),"module-name":"test"},null,8,["columns"])])]),_:1})}}}),De=k({__name:"table",setup(o){return B(()=>{x()}),(i,t)=>(y(),de("div",null,[e(ze),e(fe,{columns:n(R),table:n(v),query:n(g),"onUpdate:query":t[0]||(t[0]=s=>j(g)?g.value=s:null),"selected-keys":n(c),"onUpdate:selectedKeys":t[1]||(t[1]=s=>j(c)?c.value=s:null),form:n(l),"onUpdate:form":t[2]||(t[2]=s=>j(l)?l.value=s:null)},{default:a(({value:s})=>[s.column.dataIndex==="operation"?(y(),I(ge,{key:0,onOnClick:n(F),loading:n(v).loading,items:n(Se)},null,8,["onOnClick","loading","items"])):ce("",!0)]),_:1},8,["columns","table","query","selected-keys","form"])]))}}),Qe=k({__name:"index",setup(o){return(i,t)=>{const s=pe;return y(),I(s,{class:"system__module"},{default:a(()=>[e(De),e(Ee)]),_:1})}}});export{Qe as default};
